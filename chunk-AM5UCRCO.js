import{a as ie}from"./chunk-HAQ6RSQH.js";import{a as re}from"./chunk-KGT73NR7.js";import"./chunk-34VIIY3H.js";import"./chunk-N2LQX7VI.js";import{e as oe}from"./chunk-7PVQWRKD.js";import{c as K}from"./chunk-5BGIWNYG.js";import{d as J,f as P}from"./chunk-UV6WKCAY.js";import{b as te}from"./chunk-JQNNOW5S.js";import"./chunk-OXQFDIO2.js";import"./chunk-VKEGRMF3.js";import"./chunk-PZF2HUG4.js";import"./chunk-Q4XJYIXY.js";import"./chunk-5EH4PHE6.js";import"./chunk-XVVGP5IS.js";import"./chunk-5FDWUNFG.js";import{c as ne}from"./chunk-ABBLJOL2.js";import"./chunk-POD54P5Y.js";import"./chunk-GDV3UKUI.js";import"./chunk-GLMHSY4W.js";import"./chunk-5YWNGEST.js";import"./chunk-ONUWX4Z3.js";import"./chunk-5SLFWW7S.js";import"./chunk-PAE2UDOJ.js";import{a as ee}from"./chunk-OJKORLRC.js";import{b as Z}from"./chunk-SE4RMCUL.js";import"./chunk-S76G5ZLK.js";import"./chunk-EWAYVCWY.js";import"./chunk-7JQNGYFA.js";import"./chunk-6O3Z2ZPM.js";import"./chunk-WBS7JUSK.js";import"./chunk-4LRNZHQJ.js";import"./chunk-4YZRLV7F.js";import{$b as b,A as q,Ba as W,Da as V,Fb as M,Gb as f,Hb as E,Hc as T,Ib as $,Ob as R,Oc as F,Pb as G,Pc as D,Tb as _,_a as g,ac as I,dc as Y,e as i,f as s,fb as N,g as l,h as c,ia as h,jb as S,lb as B,na as A,nb as X,oa as Q,qc as z,ra as j,sc as H,wa as L}from"./chunk-UJ7YJEPZ.js";var ce=["uiElementVCR"],se=(()=>{let o=class o{constructor(){this.uiElementTemplate=F.required(),this.uiElementComponentRef=F.required(),this.uiElementVCR=D("uiElementVCR",{read:N})}};o.\u0275fac=function(t){return new(t||o)},o.\u0275dir=B({type:o,viewQuery:function(t,a){t&1&&b(a.uiElementVCR,ce,5,N),t&2&&I()},inputs:{uiElementTemplate:[1,"uiElementTemplate"],uiElementComponentRef:[1,"uiElementComponentRef"]}});let m=o;return m})();var he=["contextMenu"],p,x,y,C,r,le,me,k,ue,pe,u=class u extends se{constructor(){super(...arguments);s(this,r);s(this,p);s(this,x);s(this,y);s(this,C);l(this,p,h(j)),l(this,x,h(P)),this.menuItemsSig=L([]),this.isContextMenuShow=L(!1),this._contextMenuEleSig=D("contextMenu",{read:V}),l(this,y,e=>{c(this,r,k).call(this,e)&&e.preventDefault()}),l(this,C,e=>{if(c(this,r,pe).call(this,e)){this.isContextMenuShow.set(!1);return}})}displayMenu(e){if(c(this,r,ue).call(this,e)){e.stopPropagation();let n=T(this._contextMenuEleSig)?.nativeElement;if(!n){console.error("Something is wrong. Context menu element is not found!");return}let t=`${e.clientX}px`,a=`${e.clientY}px`;n.style.setProperty("--pos-x",t),n.style.setProperty("--pos-y",a),this.isContextMenuShow.set(!0);let U=T(this.uiElementTemplate).id;this.menuItemsSig.set([{label:`Edit ${U}`,icon:"pi pi-cog",command:()=>{i(this,x).navigate(["builder","ui-element",U])}}])}}ngOnInit(){i(this,p).addEventListener("contextmenu",i(this,y)),i(this,p).addEventListener("mouseup",i(this,C),{passive:!0})}ngOnDestroy(){i(this,p).removeEventListener("contextmenu",i(this,y)),i(this,p).removeEventListener("mouseup",i(this,C))}};p=new WeakMap,x=new WeakMap,y=new WeakMap,C=new WeakMap,r=new WeakSet,le=function(e){let n=T(this.uiElementComponentRef).instance.uid,t=e.target;for(;t.parentElement;){if(t.getAttribute("uid")===n)return t;t=t.parentElement}return null},me=function(e){let n=e.target;for(;n.parentElement;){if(n.id==="context-menu")return!0;n=n.parentElement}return!1},k=function(e){return!!c(this,r,le).call(this,e)},ue=function(e){return e.button===2&&c(this,r,k).call(this,e)},pe=function(e){return e.button===0&&!c(this,r,me).call(this,e)},u.EXCLUDED_ELEMENTS=new Set([te]),u.\u0275fac=(()=>{let e;return function(t){return(e||(e=W(u)))(t||u)}})(),u.\u0275cmp=S({type:u,selectors:[["prime-ng-playground-builder-feat-layout-editor-context-menu"]],viewQuery:function(n,t){n&1&&b(t._contextMenuEleSig,he,5,V),n&2&&I()},features:[X],decls:6,vars:5,consts:[["uiElementVCR",""],["contextMenu",""],[2,"display","contents",3,"mouseup"],["id","context-menu",1,"context-menu"],[3,"model"]],template:function(n,t){if(n&1){let a=G();f(0,"div",2),_("mouseup",function(d){return A(a),Q(t.displayMenu(d))}),R(1,null,0),E(),f(3,"span",3,1),$(5,"p-menu",4),E()}n&2&&(g(3),Y("hide",!t.isContextMenuShow())("show",t.isContextMenuShow()),g(2),M("model",t.menuItemsSig()))},dependencies:[ie],styles:["[_nghost-%COMP%]{display:contents;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:fixed;top:var(--pos-y);left:var(--pos-x);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0});var O=u;var ge=m=>({id:m,isLayout:!0}),Ae=(()=>{var o,e,n,t;let a=class a{constructor(){s(this,o);s(this,e);s(this,n);s(this,t);l(this,o,h(oe)),l(this,e,h(J)),l(this,n,h(P)),this.currentUIElementTemplateId=i(this,e).snapshot.params.id,l(this,t,"editRawTemplate"),this.isRawTemplateEditorModalOpenSig=K(i(this,e).queryParams.pipe(q(d=>d[i(this,t)]==="true")),{initialValue:!1}),i(this,o).updateQuery({id:this.currentUIElementTemplateId})}toggleModal(d){i(this,n).navigate([],{relativeTo:i(this,e),queryParams:{[i(this,t)]:d?!0:null},queryParamsHandling:"merge"})}};o=new WeakMap,e=new WeakMap,n=new WeakMap,t=new WeakMap,a.\u0275fac=function(w){return new(w||a)},a.\u0275cmp=S({type:a,selectors:[["prime-ng-playground-builder-feat-edit-layout-template"]],features:[z([{provide:Z,useFactory:()=>({uiElementWrapperComponent:O})}])],decls:3,vars:5,consts:[["aria-label","Open template editor","icon","pi pi-file-edit","iconPos","bottom","label","Open template editor",1,"open-template-editor-btn",3,"click"],[3,"djuiUIElementRenderer"],[3,"editCancel","query","visible"]],template:function(w,v){w&1&&(f(0,"p-button",0),_("click",function(){return v.toggleModal(!0)}),E(),R(1,1),f(2,"prime-ng-playground-builder-feat-raw-ui-element-template-editor-modal",2),_("editCancel",function(){return v.toggleModal(!1)}),E()),w&2&&(g(),M("djuiUIElementRenderer",v.currentUIElementTemplateId),g(),M("query",H(3,ge,v.currentUIElementTemplateId))("visible",v.isRawTemplateEditorModalOpenSig()))},dependencies:[ee,re,ne],styles:["[_nghost-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]{position:absolute;z-index:9997;top:1rem;right:1rem;opacity:.1;transition:opacity .2s ease-in}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]:hover{opacity:1}"],changeDetection:0});let m=a;return m})();export{Ae as EditLayoutTemplateComponent};
