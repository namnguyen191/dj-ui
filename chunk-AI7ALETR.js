import{a as A,c as F}from"./chunk-SWYIOHFY.js";import{e as R,f as q}from"./chunk-ZGJ2SCUV.js";import{a as U}from"./chunk-XHLVS7FU.js";import{a as O}from"./chunk-JOWTQUES.js";import{a as w}from"./chunk-ERB5ATM7.js";import{a as P}from"./chunk-J2UA6UJD.js";import{a as M}from"./chunk-6GF7UK45.js";import{ba as u}from"./chunk-CHX6FGWD.js";import{b as v}from"./chunk-HNFNR3GG.js";import{a as j}from"./chunk-PUECT5W6.js";import{v as b}from"./chunk-POJFSOR5.js";import{Ac as o,Bc as a,Ec as I,Hb as E,Ib as y,Jb as T,Ob as _,a as p,ea as s,hc as S,ic as C,kb as g,u as c,xb as f,ya as h,za as d}from"./chunk-CELOEL42.js";var $=()=>({}),r="dj-ui-schemas",D={[w]:`${r}/AppEditPrimeNgSimpleTableUIESchema.json`,[O]:`${r}/AppEditPrimeNgSimpleTextUIESchema.json`,[j]:`${r}/AppEditPrimeNgSimpleImageUIESchema.json`,[U]:`${r}/AppEditSimpleGridUIESchema.json`,[M]:`${r}/AppEditPrimeNgImagesCarouselUIESchema.json`,[P]:`${r}/AppEditPrimeNgCardUIESchema.json`},Z=(()=>{class l{constructor(){this.#e=s(R),this.#n=s(b),this.#i=s(u),this.#r=s(v),this.query=d.required(),this.visible=d.required(),this.editCancel=h(),this.loadingSig=a(()=>this.#e.isPending()||this.jsonSchemaConfigResource.isLoading()),this.jsonSchemaConfigResource=I({request:()=>({uiElementType:this.#t()?.type}),loader:async({request:e})=>{let{uiElementType:t}=e;return t?{schema:await c(this.#r.get(D[t])),schemaId:t}:void 0}}),this.#s=a(()=>{let e=o(this.query);return this.#e.entities().filter(q(e))}),this.#t=a(()=>{let e=this.#s();return e.length<=0?null:(e.length>1&&console.warn(`Multiple UIE templates with the same ID of ${o(this.query).id} detected. This could be an error. The first one will be selected for editing`),e[0])}),this.currentEditableFieldsSig=a(()=>{let e=this.#t();if(!e)return null;let{name:t,description:i,remoteResourceIds:n,stateSubscription:m,options:L,eventsHooks:N}=e;return{name:t,description:i,remoteResourceIds:n,stateSubscription:m,options:L,eventsHooks:N}})}#e;#n;#i;#r;#s;#t;async updateUIElementTemplate(e){let t=JSON.parse(e),i=o(this.#t);if(!i)return;let n=p(p({},i),t);await this.#e.change(n),o(this.#e.error)?this.#i.add({severity:"error",summary:"Template saved failure",detail:"Your UIE template could not be saved, please try again later or refresh the page",life:9999}):(this.#i.add({severity:"success",summary:"Template saved successfully",detail:"Your UIE template has been successfully saved",life:3e3}),this.#n.updateTemplate(n))}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275cmp=g({type:l,selectors:[["prime-ng-playground-builder-feat-raw-ui-element-template-editor-modal"]],inputs:{query:[1,"query"],visible:[1,"visible"]},outputs:{editCancel:"editCancel"},features:[S([u])],decls:2,vars:5,consts:[[3,"editCancel","save","isLoading","isOpen","jsonObj","schemaConfig"],[1,"toast"]],template:function(t,i){if(t&1&&(E(0,"prime-ng-playground-builder-feat-json-editor-modal",0),_("editCancel",function(){return i.editCancel.emit()})("save",function(m){return i.updateUIElementTemplate(m)}),y(),T(1,"p-toast",1)),t&2){let n;f("isLoading",i.loadingSig())("isOpen",i.visible())("jsonObj",(n=i.currentEditableFieldsSig())!==null&&n!==void 0?n:C(4,$))("schemaConfig",i.jsonSchemaConfigResource.value())}},dependencies:[F,A],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]     .p-dialog-mask{z-index:9998!important}[_nghost-%COMP%]   .toast[_ngcontent-%COMP%]{z-index:10000}"],changeDetection:0})}}return l})();export{Z as a};
