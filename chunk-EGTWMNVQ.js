import{a as N,b as $e,c as Ye,d as Ke,e as Xe}from"./chunk-5FX74NIL.js";import{a as xe}from"./chunk-2AXIN3SY.js";import"./chunk-5P3WC3WX.js";import"./chunk-XSHXIKD3.js";import{a as Ue}from"./chunk-GFXNHRWD.js";import{a as j}from"./chunk-2XVQPNSU.js";import{a as Le,b as Te}from"./chunk-AUPDVPWC.js";import{a as De,b as Pe}from"./chunk-VT3L4ATN.js";import{a as We,b as Je,c as Ge,e as Qe,f as qe}from"./chunk-O2IUUI6A.js";import{a as Ae,b as Ve,c as Be,d as Fe,e as Ne,f as je,g as He,h as Re}from"./chunk-PPSOSOLW.js";import"./chunk-O6NCSUHF.js";import"./chunk-FI4W5XJG.js";import{c as ze}from"./chunk-QGTZ7D3Z.js";import"./chunk-VIZDSAUF.js";import"./chunk-ODVR7ZJH.js";import"./chunk-W55HETMF.js";import{D as F,p as Oe,t as ke}from"./chunk-KMDEKQMR.js";import{b as be,d as we,e as B}from"./chunk-YFNKZN5I.js";import{d as Ee,f as Se}from"./chunk-XJT726ZN.js";import{a as V,b as I,c as x}from"./chunk-JPM3QN3O.js";import"./chunk-OWN4CUHW.js";import{c as Ie,d as K}from"./chunk-EWUWNZZG.js";import"./chunk-CB73VGS7.js";import"./chunk-HAEKH4MG.js";import"./chunk-RNE5JESU.js";import"./chunk-SPYAYC6H.js";import{$a as r,$b as pe,Ab as a,Ac as M,Ba as W,Bc as $,Cb as P,Cc as A,Da as w,F as ae,Fb as Q,Hc as ve,Kb as s,Lb as l,Mb as u,Nb as _,Ob as C,Pb as ce,Pc as Me,Qb as O,Rb as h,Sb as c,Sc as k,Tb as q,U,Ub as z,Wc as Y,Yc as T,Z as re,_b as me,bb as J,bc as g,ca as m,cc as ue,f as ne,hb as se,hc as ge,ic as fe,jc as _e,kc as Ce,la as E,lb as v,ma as S,mb as de,mc as he,na as y,oa as L,pb as D,qc as ye,r as oe,rb as p,va as le,zb as G}from"./chunk-J33AFEAQ.js";import{a as b,b as te,c as ie}from"./chunk-VKRCUX5N.js";var Ze={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"circle",attrs:{cx:"23",cy:"24",r:"2"}},{elem:"path",attrs:{d:"M30.7769 23.4785A8.64 8.64 0 0023 18a8.64 8.64 0 00-7.7769 5.4785L15 24l.2231.5215A8.64 8.64 0 0023 30a8.64 8.64 0 007.7769-5.4785L31 24zM23 28a4 4 0 114-4A4.0045 4.0045 0 0123 28zM12.3989 20.8A6 6 0 1122 16H20a4 4 0 10-6.4 3.2z"}},{elem:"path",attrs:{d:"M29.3047,11.0439,26.9441,6.9561a1.9977,1.9977,0,0,0-2.3728-.8946l-2.4341.8233a11.0419,11.0419,0,0,0-1.312-.7583l-.5037-2.5186A2,2,0,0,0,18.36,2H13.64a2,2,0,0,0-1.9611,1.6079l-.5037,2.5186A10.9666,10.9666,0,0,0,9.8481,6.88L7.4287,6.0615a1.9977,1.9977,0,0,0-2.3728.8946L2.6953,11.0439a2.0006,2.0006,0,0,0,.4119,2.5025l1.9309,1.6968C5.021,15.4946,5,15.7446,5,16c0,.2578.01.5127.0278.7656l-1.9206,1.688a2.0006,2.0006,0,0,0-.4119,2.5025l2.3606,4.0878a1.9977,1.9977,0,0,0,2.3728.8946l2.4341-.8233a10.9736,10.9736,0,0,0,1.312.7583l.5037,2.5186A2,2,0,0,0,13.64,30H15V28H13.64l-.71-3.5508a9.0953,9.0953,0,0,1-2.6948-1.5713l-3.4468,1.166-2.36-4.0878L7.1528,17.561a8.9263,8.9263,0,0,1-.007-3.1279L4.4275,12.0439,6.7886,7.9561l3.4267,1.1591a9.0305,9.0305,0,0,1,2.7141-1.5644L13.64,4H18.36l.71,3.5508a9.0978,9.0978,0,0,1,2.6948,1.5713l3.4468-1.166,2.36,4.0878-2.7978,2.4522L26.0923,16l2.8-2.4536A2.0006,2.0006,0,0,0,29.3047,11.0439Z"}}],name:"settings--view",size:16};var ct=["*"],mt=(t,n,e,i,o,d,f,R,rt,lt,st)=>({"cds--contained-list--inset-rulers":t,"cds--contained-list--on-page":n,"cds--contained-list--disclosed":e,"cds--contained-list--sm":i,"cds--contained-list--md":o,"cds--contained-list--lg":d,"cds--contained-list--xl":f,"cds--layout--size-sm":R,"cds--layout--size-md":rt,"cds--layout--size-lg":lt,"cds--layout--size-xl":st});function pt(t,n){if(t&1&&(_(0),g(1),C()),t&2){let e=c();r(),ue(e.label)}}function ut(t,n){}function gt(t,n){if(t&1&&p(0,ut,0,0,"ng-template",6),t&2){let e=c();a("ngTemplateOutlet",e.label)}}function ft(t,n){}function _t(t,n){if(t&1&&(s(0,"div",7),p(1,ft,0,0,"ng-template",6),l()),t&2){let e=c();r(),a("ngTemplateOutlet",e.action)}}var Ct=[[["","cdsContainedListItemButton",""],["","ibmContainedListItemButton",""]],"*"],ht=["[cdsContainedListItemButton],[ibmContainedListItemButton]","*"],yt=t=>({$implicit:t});function vt(t,n){if(t&1){let e=O();_(0),s(1,"button",2),h("click",function(){E(e);let o=c();return S(o.onClick())}),z(2),l(),C()}if(t&2){let e=c();r(),a("disabled",e.disabled)}}function Mt(t,n){if(t&1&&(_(0),y(),u(1,"svg",6),C()),t&2){let e=c(3);r(),a("ibmIcon",e.icon)}}function Et(t,n){}function St(t,n){if(t&1&&p(0,Et,0,0,"ng-template",7),t&2){let e=c(3);a("ngTemplateOutlet",e.icon)}}function Lt(t,n){if(t&1&&(s(0,"div",5),p(1,Mt,2,1,"ng-container",0)(2,St,1,1,null,0),l()),t&2){let e=c(2);r(),a("ngIf",!e.isTemplate(e.icon)),r(),a("ngIf",e.isTemplate(e.icon))}}function Tt(t,n){if(t&1&&(_(0),s(1,"div",3),p(2,Lt,3,2,"div",4),z(3,1),l(),C()),t&2){let e=c();r(2),a("ngIf",e.icon)}}function It(t,n){}function xt(t,n){if(t&1&&(s(0,"div",8),p(1,It,0,0,"ng-template",9),l()),t&2){let e=c();r(),a("ngTemplateOutlet",e.action)("ngTemplateOutletContext",he(2,yt,e.actionData))}}var X=function(t){return t.Small="sm",t.Medium="md",t.Large="lg",t.ExtraLarge="xl",t}(X||{}),Z=function(t){return t.OnPage="on-page",t.Disclosed="disclosed",t}(Z||{}),et=(()=>{class t{constructor(){this.isInset=!1,this.kind=Z.OnPage,this.size=X.Large,this.labelId=`contained-list-${t.count++}-header`,this.ContainedListSize=X,this.ContainedListKind=Z}isTemplate(e){return e instanceof J}}return t.count=0,t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=v({type:t,selectors:[["cds-contained-list"],["ibm-contained-list"]],inputs:{action:"action",isInset:"isInset",kind:"kind",label:"label",size:"size",labelId:"labelId"},standalone:!1,ngContentSelectors:ct,decls:8,vars:18,consts:[[1,"cds--contained-list",3,"ngClass"],[1,"cds--contained-list__header"],[1,"cds--contained-list__label",3,"id"],[4,"ngIf"],["class","cds--contained-list__action",4,"ngIf"],["role","list"],[3,"ngTemplateOutlet"],[1,"cds--contained-list__action"]],template:function(e,i){e&1&&(q(),s(0,"div",0)(1,"div",1)(2,"div",2),p(3,pt,2,1,"ng-container",3)(4,gt,1,1,null,3),l(),p(5,_t,2,1,"div",4),l(),s(6,"div",5),z(7),l()()),e&2&&(a("ngClass",ye(6,mt,[i.isInset,i.kind===i.ContainedListKind.OnPage,i.kind===i.ContainedListKind.Disclosed,i.size===i.ContainedListSize.Small,i.size===i.ContainedListSize.Medium,i.size===i.ContainedListSize.Large,i.size===i.ContainedListSize.ExtraLarge,i.size===i.ContainedListSize.Small,i.size===i.ContainedListSize.Medium,i.size===i.ContainedListSize.Large,i.size===i.ContainedListSize.ExtraLarge])),r(2),a("id",i.labelId),r(),a("ngIf",!i.isTemplate(i.label)),r(),a("ngIf",i.isTemplate(i.label)),r(),a("ngIf",i.action),r(),G("aria-labelledby",i.labelId))},dependencies:[Me,k,Y],encapsulation:2,changeDetection:0}),t})(),tt=(()=>{class t{constructor(){this.disabled=!1,this.click=new le,this.itemClass=!0,this.role="listitem"}get itemClickableClass(){return this.clickable}get itemWithIconClass(){return!!this.icon}onClick(){this.click.emit()}isTemplate(e){return e instanceof J}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=v({type:t,selectors:[["cds-contained-list-item"],["ibm-contained-list-item"]],hostVars:7,hostBindings:function(e,i){e&2&&(G("role",i.role),P("cds--contained-list-item",i.itemClass)("cds--contained-list-item--clickable",i.itemClickableClass)("cds--contained-list-item--with-icon",i.itemWithIconClass))},inputs:{action:"action",actionData:"actionData",disabled:"disabled",clickable:"clickable",icon:"icon"},outputs:{click:"click"},standalone:!1,ngContentSelectors:ht,decls:3,vars:3,consts:[[4,"ngIf"],["class","cds--contained-list-item__action",4,"ngIf"],["type","button",1,"cds--contained-list-item__content",3,"click","disabled"],[1,"cds--contained-list-item__content"],["class","cds--contained-list-item__icon",4,"ngIf"],[1,"cds--contained-list-item__icon"],["size","16",3,"ibmIcon"],[3,"ngTemplateOutlet"],[1,"cds--contained-list-item__action"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,i){e&1&&(q(Ct),p(0,vt,3,1,"ng-container",0)(1,Tt,4,1,"ng-container",0)(2,xt,2,4,"div",1)),e&2&&(a("ngIf",i.clickable),r(),a("ngIf",!i.clickable),r(),a("ngIf",i.action))},dependencies:[k,Y,I],encapsulation:2,changeDetection:0}),t})(),it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=de({type:t}),t.\u0275inj=re({imports:[T,x]}),t})();var wt=["contextMenu"],ot=(()=>{class t extends Ie{#e;#i;#t;#n;constructor(){super(),this.#e=m(ve),this.#i=m(V),this.isContextMenuShow=w(!1),this._contextMenuEleSig=se("contextMenu",{read:W}),this.#t=e=>{this.#r(e)&&e.preventDefault()},this.#n=e=>{if(this.#s(e)){this.isContextMenuShow.set(!1);return}if(this.#l(e)&&!this.#o(e)){let i=M(this._contextMenuEleSig)?.nativeElement;if(!i){console.error("Something is wrong. Context menu element is not found!");return}let d=this.#a(e).getBoundingClientRect(),f=`${e.clientX-d.left}px`,R=`${e.clientY-d.top}px`;i.style.setProperty("--pos-x",f),i.style.setProperty("--pos-y",R),this.isContextMenuShow.set(!0)}},this.#i.registerAll([N,Ze])}ngOnInit(){this.#e.addEventListener("contextmenu",this.#t),this.#e.addEventListener("mouseup",this.#n,{passive:!0})}ngOnDestroy(){this.#e.removeEventListener("contextmenu",this.#t),this.#e.removeEventListener("mouseup",this.#n)}#a(e){let i=M(this.uiElementInstance).id;if(!i)throw new Error("Element instance ID has not been received");let o=e.target;for(;o.parentElement;){if(o.className==="grid-item"&&o.id===i)return o;o=o.parentElement}return null}#o(e){let i=e.target;for(;i.parentElement;){if(i.id==="context-menu")return!0;i=i.parentElement}return!1}#r(e){return!!this.#a(e)}#l(e){return e.button===2&&this.#r(e)}#s(e){return e.button===0&&!this.#o(e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["namnguyen191-dui-ui-element-builder-context-menu-wrapper"]],viewQuery:function(i,o){i&1&&me(o._contextMenuEleSig,wt,5,W),i&2&&pe()},features:[D],decls:28,vars:8,consts:[["uiElementVCR",""],["contextMenu",""],["id","context-menu","label","Control menu",1,"context-menu"],[3,"clickable"],["ibmContainedListItemButton",""],[1,"control-menu-item"],["cdsIcon","edit","size","16"],["cdsIcon","settings--view","size","16"],["cdsIcon","copy","size","16"],["cdsIcon","trash-can","size","16"]],template:function(i,o){i&1&&(ce(0,null,0),s(2,"cds-contained-list",2,1)(4,"cds-contained-list-item",3),_(5,4),s(6,"div",5)(7,"span"),g(8,"Edit"),l(),y(),u(9,"svg",6),l(),C(),l(),L(),s(10,"cds-contained-list-item",3),_(11,4),s(12,"div",5)(13,"span"),g(14,"View details"),l(),y(),u(15,"svg",7),l(),C(),l(),L(),s(16,"cds-contained-list-item",3),_(17,4),s(18,"div",5)(19,"span"),g(20,"Duplicate"),l(),y(),u(21,"svg",8),l(),C(),l(),L(),s(22,"cds-contained-list-item",3),_(23,4),s(24,"div",5)(25,"span"),g(26,"Delete"),l(),y(),u(27,"svg",9),l(),C(),l()()),i&2&&(r(2),P("hide",!o.isContextMenuShow())("show",o.isContextMenuShow()),r(2),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0))},dependencies:[T,it,et,tt,x,I],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:absolute;top:var(--pos-y);left:var(--pos-x);width:10rem;background:var(--cds-layer-active-01);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]   .control-menu-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}}return t})();var Ot={currentEditingTemplate:null},H=Je({providedIn:"root"},qe(Ot),Ge(({currentEditingTemplate:t})=>({currentEditableFields:$(()=>{let n=t();if(!n)return null;let f=n,{id:e,createdAt:i,updatedAt:o}=f;return ie(f,["id","createdAt","updatedAt"])}),currentUnEditableFields:$(()=>{let n=t();if(!n)return null;let{id:e,createdAt:i,updatedAt:o}=n;return{id:e,createdAt:i,updatedAt:o}})})),Qe(t=>({setCurrentEditingTemplate:n=>{We(t,{currentEditingTemplate:n})},updateCurrentEditingTemplate:n=>{$e(t,e=>{let i=M(t.currentUnEditableFields);!e.currentEditingTemplate||!i||(e.currentEditingTemplate=b(b({},i),n))})}})));function kt(t,n){t&1&&u(0,"cds-loading",5),t&2&&a("isActive",!0)}function Dt(t,n){if(t&1){let e=O();s(0,"ngx-monaco-editor",9),h("ngModelChange",function(o){E(e);let d=c();return S(d.codeChangeSubject.next(o))}),l()}if(t&2){let e=c(),i=_e(1);a("ngModel",i)("options",e.editorOptions)}}function Pt(t,n){t&1&&g(0," Error in JSON ")}function zt(t,n){t&1&&g(0," Save your changes ")}function At(t,n){t&1&&u(0,"cds-loading",10)}var at=(()=>{class t extends Ae{#e;#i;#t;constructor(){super(),this.#e=m(j),this.#i=m(H),this.loadingSig=this.#e.isPending,this.codeChangeSubject=new ne,this.editorOptions={theme:"vs-dark",language:"json",wordWrap:"on"},this.codeSig=w(""),this.errorStateSig=w("noError"),this.#t="",this.codeChangeSubject.pipe(U({next:()=>{this.errorStateSig.set("isPending")}}),ae(500),U({next:e=>{this.codeSig.set(e),this.#o(e)?this.errorStateSig.set("noError"):this.errorStateSig.set("isError")}}),Le()).subscribe(),this.#n()}async updateLayoutTemplate(){let e=JSON.parse(M(this.codeSig));this.#i.updateCurrentEditingTemplate(e);let i=M(this.#i.currentEditingTemplate);if(!i){console.error("Edited template is missing from store");return}await this.#e.change(i),M(this.#e.error)||this.closeModal()}#n(){A(async()=>{let e=this.#i.currentEditableFields();if(!e)return;let i=JSON.stringify(e),o=await this.#a(i);this.#t=o,this.codeSig.set(o)})}async#a(e){return console.log("Nam data is: are we here"),await Xe(e,{parser:"json",plugins:[Ye,Ke]})}#o(e){try{return JSON.parse(e),!0}catch(i){return console.log("Something went wrong:",i),!1}}closeModal(){this.codeSig.set(this.#t),super.closeModal()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["namnguyen191-layout-template-code-editor-modal"]],features:[D],decls:16,vars:7,consts:[["size","lg",3,"overlaySelected","open"],[3,"closeSelect","showCloseButton"],["cdsModalHeaderLabel",""],["cdsModalHeaderHeading",""],["cdsModalContent","",1,"modal-body"],[3,"isActive"],[1,"editor-container",3,"ngModel","options"],["cdsButton","primary",3,"click","disabled"],["size","sm",4,"ngIf"],[1,"editor-container",3,"ngModelChange","ngModel","options"],["size","sm"]],template:function(i,o){if(i&1){let d=O();ge(0)(1),s(2,"cds-modal",0),h("overlaySelected",function(){return E(d),S(o.closeModal())}),s(3,"cds-modal-header",1),h("closeSelect",function(){return E(d),S(o.closeModal())}),s(4,"h2",2),g(5,"Editor"),l(),s(6,"h3",3),g(7,"Edit your template in JSON"),l()(),s(8,"section",4),p(9,kt,1,1,"cds-loading",5)(10,Dt,1,2,"ngx-monaco-editor",6),l(),s(11,"cds-modal-footer")(12,"button",7),h("click",function(){return E(d),S(o.updateLayoutTemplate())}),p(13,Pt,1,0)(14,zt,1,0)(15,At,1,0,"cds-loading",8),l()()()}if(i&2){let d=o.errorStateSig();r();let f=fe(o.codeSig());r(),a("open",o.open),r(),a("showCloseButton",!0),r(6),Q(o.loadingSig()||!f?9:10),r(3),a("disabled",d==="isError"||d==="isPending"),r(),Q(d==="isError"?13:14),r(2),a("ngIf",d==="isPending")}},dependencies:[T,k,Re,Ve,Be,Fe,Ne,je,He,Ue,F,Oe,ke,Pe,De,B,be,ze],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]{height:70vh;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]   .editor-container[_ngcontent-%COMP%]{height:100%;flex:1}"],changeDetection:0})}}return t})();var Ni=(()=>{class t{#e;#i;#t;#n;#a;#o;constructor(){this.#e=m(Ee),this.#i=m(Se),this.#t=m(j),this.#n=m(H),this.#a=m(V),this.currentLayoutTemplateId=this.#e.snapshot.params.id,this.#o="editRawTemplate",this.isRawTemplateEditorModalOpenSig=Te(this.#e.queryParams.pipe(oe(e=>e[this.#o]==="true")),{initialValue:!1}),this.#a.registerAll([N]),this.#t.updateQuery({id:this.currentLayoutTemplateId}),this.#r()}toggleModal(e){this.#i.navigate([],{relativeTo:this.#e,queryParams:{[this.#o]:e?!0:null},queryParamsHandling:"merge"})}#r(){A(()=>{let e=this.#t.filteredLayoutTemplates()[0];e&&this.#n.setCurrentEditingTemplate(e)})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["namnguyen191-edit-layout-page"]],features:[Ce([{provide:K,useFactory:()=>{let e=m(K,{skipSelf:!0});return te(b({},e),{uiElementExtraWrapperComponent:ot})}}])],decls:4,vars:3,consts:[[3,"layoutId"],["type","button",1,"edit-template-button",3,"click","kind"],["cdsIcon","edit","size","16",1,"cds--btn__icon"],[3,"close","open"]],template:function(i,o){i&1&&(u(0,"djui",0),s(1,"cds-icon-button",1),h("click",function(){return o.toggleModal(!0)}),y(),u(2,"svg",2),l(),L(),s(3,"namnguyen191-layout-template-code-editor-modal",3),h("close",function(){return o.toggleModal(!1)}),l()),i&2&&(a("layoutId",o.currentLayoutTemplateId),r(),a("kind","primary"),r(2),a("open",o.isRawTemplateEditorModalOpenSig()))},dependencies:[xe,F,B,we,x,I,at],styles:["[_nghost-%COMP%]{min-height:calc(100vh - 3rem);display:block;position:relative}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;opacity:.25;z-index:1000}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]:hover{opacity:1}"],changeDetection:0})}}return t})();export{Ni as EditLayoutPageComponent};
