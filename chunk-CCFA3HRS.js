import{a as j}from"./chunk-2ATLWR2O.js";import{a as N}from"./chunk-OH7HQMCD.js";import{e as B}from"./chunk-QQEFRTNR.js";import{c as k}from"./chunk-4XPXTYOG.js";import{d as V,f as C}from"./chunk-2HFDSWQC.js";import{b as Q}from"./chunk-YCJXFYTF.js";import"./chunk-MXCMLTXE.js";import"./chunk-VU2VV7MO.js";import"./chunk-OSMYII6X.js";import"./chunk-REOBOYNI.js";import"./chunk-LTD4J5N5.js";import{d as W}from"./chunk-ESWV3MIU.js";import"./chunk-7W3CUNRF.js";import"./chunk-HMUJRIQ5.js";import"./chunk-PJHEGPYG.js";import"./chunk-3724PXIC.js";import"./chunk-NRZLNF2B.js";import"./chunk-K3XPARKR.js";import{d as q,e as A}from"./chunk-OHYWK6D6.js";import"./chunk-UQRMQSXH.js";import"./chunk-FUMZHXM6.js";import"./chunk-UZX7OVLJ.js";import{Aa as v,Ac as y,Ca as _,Hb as s,Ib as l,Jb as O,Jc as F,Mb as h,Nb as D,Ob as p,Wb as f,Xb as E,_a as a,ea as r,fb as x,gb as c,hc as L,jc as U,kb as d,la as I,ma as S,mb as R,oa as T,ob as b,w,xb as u,za as M,zb as P}from"./chunk-CELOEL42.js";var Y=["uiElementVCR"],$=(()=>{class i{constructor(){this.uiElementTemplate=M.required(),this.uiElementComponentRef=M.required(),this.uiElementVCR=c("uiElementVCR",{read:x})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=R({type:i,viewQuery:function(n,o){n&1&&f(o.uiElementVCR,Y,5,x),n&2&&E()},inputs:{uiElementTemplate:[1,"uiElementTemplate"],uiElementComponentRef:[1,"uiElementComponentRef"]}})}}return i})();var z=["contextMenu"],g=class i extends ${constructor(){super(...arguments),this.#e=r(F),this.#t=r(C),this.menuItemsSig=_([]),this.isContextMenuShow=_(!1),this._contextMenuEleSig=c("contextMenu",{read:v}),this.#i=e=>{this.#o(e)&&e.preventDefault()},this.#n=e=>{if(this.#l(e)){this.isContextMenuShow.set(!1);return}}}static{this.EXCLUDED_ELEMENTS=new Set([Q])}#e;#t;#i;displayMenu(e){if(this.#s(e)){e.stopPropagation();let t=y(this._contextMenuEleSig)?.nativeElement;if(!t){console.error("Something is wrong. Context menu element is not found!");return}let n=`${e.clientX}px`,o=`${e.clientY}px`;t.style.setProperty("--pos-x",n),t.style.setProperty("--pos-y",o),this.isContextMenuShow.set(!0);let m=y(this.uiElementTemplate).id;this.menuItemsSig.set([{label:`Edit ${m}`,icon:"pi pi-cog",command:()=>{this.#t.navigate(["builder","ui-element",m])}}])}}#n;ngOnInit(){this.#e.addEventListener("contextmenu",this.#i),this.#e.addEventListener("mouseup",this.#n,{passive:!0})}ngOnDestroy(){this.#e.removeEventListener("contextmenu",this.#i),this.#e.removeEventListener("mouseup",this.#n)}#r(e){let t=y(this.uiElementComponentRef).instance.uid;if(!t)throw new Error("Element instance ID has not been received");let n=e.target;for(;n.parentElement;){if(n.getAttribute("uid")===t)return n;n=n.parentElement}return null}#a(e){let t=e.target;for(;t.parentElement;){if(t.id==="context-menu")return!0;t=t.parentElement}return!1}#o(e){return!!this.#r(e)}#s(e){return e.button===2&&this.#o(e)}#l(e){return e.button===0&&!this.#a(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=T(i)))(n||i)}})()}static{this.\u0275cmp=d({type:i,selectors:[["prime-ng-playground-builder-feat-layout-editor-context-menu"]],viewQuery:function(t,n){t&1&&f(n._contextMenuEleSig,z,5,v),t&2&&E()},features:[b],decls:6,vars:5,consts:[["uiElementVCR",""],["contextMenu",""],[2,"display","contents",3,"mouseup"],["id","context-menu",1,"context-menu"],[3,"model"]],template:function(t,n){if(t&1){let o=D();s(0,"div",2),p("mouseup",function(G){return I(o),S(n.displayMenu(G))}),h(1,null,0),l(),s(3,"span",3,1),O(5,"p-menu",4),l()}t&2&&(a(3),P("hide",!n.isContextMenuShow())("show",n.isContextMenuShow()),a(2),u("model",n.menuItemsSig()))},dependencies:[j],styles:["[_nghost-%COMP%]{display:contents;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:fixed;top:var(--pos-y);left:var(--pos-x);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}};var H=i=>({id:i,isLayout:!0}),ve=(()=>{class i{#e;#t;#i;#n;constructor(){this.#e=r(B),this.#t=r(V),this.#i=r(C),this.currentUIElementTemplateId=this.#t.snapshot.params.id,this.#n="editRawTemplate",this.isRawTemplateEditorModalOpenSig=k(this.#t.queryParams.pipe(w(t=>t[this.#n]==="true")),{initialValue:!1}),this.#e.updateQuery({id:this.currentUIElementTemplateId})}toggleModal(t){this.#i.navigate([],{relativeTo:this.#t,queryParams:{[this.#n]:t?!0:null},queryParamsHandling:"merge"})}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=d({type:i,selectors:[["prime-ng-playground-builder-feat-edit-layout-template"]],features:[L([{provide:q,useFactory:()=>({uiElementWrapperComponent:g})}])],decls:3,vars:5,consts:[["aria-label","Open template editor","icon","pi pi-file-edit","iconPos","bottom","label","Open template editor",1,"open-template-editor-btn",3,"click"],[3,"djuiUIElementRenderer"],[3,"editCancel","query","visible"]],template:function(n,o){n&1&&(s(0,"p-button",0),p("click",function(){return o.toggleModal(!0)}),l(),h(1,1),s(2,"prime-ng-playground-builder-feat-raw-template-editor-modal",2),p("editCancel",function(){return o.toggleModal(!1)}),l()),n&2&&(a(),u("djuiUIElementRenderer",o.currentUIElementTemplateId),a(),u("query",U(3,H,o.currentUIElementTemplateId))("visible",o.isRawTemplateEditorModalOpenSig()))},dependencies:[A,N,W],styles:["[_nghost-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]{position:absolute;z-index:9998;top:1rem;right:1rem;opacity:.1;transition:opacity .2s ease-in}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]:hover{opacity:1}"],changeDetection:0})}}return i})();export{ve as EditLayoutTemplateComponent};
