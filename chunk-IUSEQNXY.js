import{c as te}from"./chunk-URY4KJIZ.js";import{a as ie,b as ne}from"./chunk-K4CJI7RR.js";import{a as ce}from"./chunk-X7BGHBOH.js";import"./chunk-AVQT7YHK.js";import{a as me}from"./chunk-ET2GWYWS.js";import"./chunk-LLLXTKEK.js";import{a as c,b as de,c as ue}from"./chunk-BXRE4WUR.js";import{c as oe,d as re,e as ae,f as le,g as se}from"./chunk-JRTCKBMB.js";import{E as ee,n as J,o as g,p as K,q as Q,r as W,s as f,u as X,w as Y,x as Z}from"./chunk-IMW6CZRX.js";import{b as H,c as $,e as z}from"./chunk-OODSUOXW.js";import{f as G,g as U,k as j}from"./chunk-HOXVOTVY.js";import"./chunk-F3GE6OJC.js";import{a as B}from"./chunk-BUINW6WJ.js";import"./chunk-TV56DAVP.js";import{$a as n,$c as R,A as b,Cb as t,D as M,Mb as l,Nb as s,Ob as d,Sb as E,T as S,Tb as I,Ub as q,Vc as k,cc as O,da as p,dc as u,jc as V,l as v,ma as N,mb as P,na as F,nc as A,r as L,tb as h,wc as D}from"./chunk-RVPXDSFJ.js";import{a as T,b as C}from"./chunk-Q7L6LLAK.js";var pe=()=>[".."];function ge(i,y){i&1&&d(0,"cds-loading",12),i&2&&t("isActive",!0)("overlay",!0)}function fe(i,y){if(i&1&&d(0,"cds-inline-loading",13),i&2){let e=q();t("state",e.getIdFieldState())}}var ye=()=>{let i=p(me);return y=>b(500).pipe(S(()=>i.fetchLayoutTemplate(y.value)),L(()=>({idNotUnique:!0})),M(e=>e instanceof B&&e.status===404?v(null):v({idNotUnique:!0})))},qe=(()=>{class i{constructor(){this.#e=p(ce),this.loadingSig=this.#e.isPending,this.#t=p(G),this.newLayoutForm=new W({id:new f("",{nonNullable:!0,validators:[g.required],asyncValidators:[ye()]}),name:new f("",{nonNullable:!0,validators:[g.required]}),description:new f("",{nonNullable:!0,validators:[g.required]})})}#e;#t;getFieldErrorMessage(e){let r=this.newLayoutForm.controls[e];if(!r.touched)return"";let o=r.errors;if(o===null)return"";let a=[];for(let m in o)switch(m){case"required":a.push("This field is required");break;case"idNotUnique":a.push("This ID is not unique");break;default:a.push(`Unknown error: ${m}`);break}return a.join(". ")}getIdFieldState(){let e=this.newLayoutForm.controls.id;return e.pristine?c.Hidden:e.pending?c.Active:e.invalid?c.Error:c.Finished}async onSubmit(){let e=C(T({},this.newLayoutForm.getRawValue()),{uiElementInstances:[]}),r=await this.#e.add(e);this.#t.navigateByUrl(`layout-builder/edit/${r.id}`)}static{this.\u0275fac=function(r){return new(r||i)}}static{this.\u0275cmp=P({type:i,selectors:[["namnguyen191-new-layout-page"]],decls:22,vars:15,consts:[["idValidationLoading",""],[3,"isActive","overlay",4,"ngIf"],[1,"new-layout-form",3,"ngSubmit","formGroup"],[1,"new-layout-form__btn-container"],["cdsButton","","type","submit",3,"disabled"],["cdsButton","secondary","type","button",3,"routerLink"],[3,"helperText","invalid","invalidText"],["cdsText","","formControlName","id",3,"autocomplete"],["helperText","The name of the layout",3,"invalid","invalidText"],["cdsText","","formControlName","name",3,"autocomplete"],["helperText","Give your layout a good description",1,"new-layout-form__description-text-area",3,"invalid","invalidText"],["cdsTextArea","","formControlName","description",1,"textarea-field",3,"rows"],[3,"isActive","overlay"],["errorText","This id is not unique","loadingText","Checking id...","successText","This id is unique",3,"state"]],template:function(r,o){if(r&1){let a=E();V(0)(1)(2)(3),h(4,ge,1,2,"cds-loading",1),l(5,"form",2),I("ngSubmit",function(){return N(a),F(o.onSubmit())}),l(6,"cds-button-set",3)(7,"button",4),u(8,"Create"),s(),l(9,"button",5),u(10,"Cancel"),s()(),l(11,"cds-text-label",6),u(12," Id "),d(13,"input",7),s(),l(14,"cds-text-label",8),u(15," Name "),d(16,"input",9),s(),l(17,"cds-textarea-label",10),u(18," Description "),d(19,"textarea",11),s()(),h(20,fe,1,1,"ng-template",null,0,D)}if(r&2){let a=O(21),m=o.loadingSig(),_=o.getFieldErrorMessage("id"),x=o.getFieldErrorMessage("name"),w=o.getFieldErrorMessage("description");n(4),t("ngIf",m),n(),t("formGroup",o.newLayoutForm),n(2),t("disabled",!o.newLayoutForm.valid),n(2),t("routerLink",A(14,pe)),n(2),t("helperText",a)("invalid",!!_)("invalidText",_),n(2),t("autocomplete",!1),n(),t("invalid",!!x)("invalidText",x),n(2),t("autocomplete",!1),n(),t("invalid",!!w)("invalidText",w),n(2),t("rows",20)}},dependencies:[R,k,ee,X,J,K,Q,Y,Z,se,ae,le,oe,re,z,H,$,ne,ie,te,ue,de,j,U],styles:["[_nghost-%COMP%]{height:calc(100vh - 3rem);display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]   .new-layout-form[_ngcontent-%COMP%]{flex-grow:1;display:grid;grid-template-columns:1fr 1fr;gap:3rem;padding:0 10rem}[_nghost-%COMP%]   .new-layout-form__description-text-area[_ngcontent-%COMP%]{grid-column:span 2}[_nghost-%COMP%]   .new-layout-form__description-text-area[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .new-layout-form__btn-container[_ngcontent-%COMP%]{grid-column:span 2;display:flex;justify-content:flex-end;gap:1rem;align-items:end}"],changeDetection:0})}}return i})();export{qe as NewLayoutPageComponent};
