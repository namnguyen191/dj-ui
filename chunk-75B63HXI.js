import{c as T}from"./chunk-LX3RPK2E.js";import{i as F,j as k,n as Y}from"./chunk-AWNXAW2C.js";import{Ba as R,Da as A,Gc as K,Hc as U,Ic as y,Jc as D,N as q,Y as H,Z as V,a as M,b as O,e as c,f as m,g,ia as C,lb as S,n as B,nb as b,ob as W}from"./chunk-UJ7YJEPZ.js";var w=o=>{let{ele:e,attrName:i,attrValue:t}=o,n=e.parentElement,h=[];for(;n;){let r=n.getAttribute(i);if(r===null){n=n.parentElement;continue}if(h.push(r),r===t)return{contains:!0,chain:h};n=n.parentElement}return{contains:!1,chain:h}};var $=(()=>{var e,i,t;let n=class n extends T{constructor(){super(...arguments);m(this,e);m(this,i);m(this,t);g(this,e,C(A)),g(this,i,this.elementRendererConfig?.uiElementInfiniteErrorComponent),this.isInfinite=y(()=>{let d=this.uiElementTemplateId(),E=c(this,e).nativeElement,{contains:p,chain:u}=w({ele:E,attrName:"elementTemplateId",attrValue:d});if(p){let s=[...u,d].join(" -> ");console.error(`UI element with id ${d} has already existed in parents. Check ${s}`)}return p}),g(this,t,D(()=>{this.isInfinite()&&(this.viewContainerRef.clear(),c(this,i)&&this.viewContainerRef.createComponent(c(this,i)))}))}};e=new WeakMap,i=new WeakMap,t=new WeakMap,n.\u0275fac=(()=>{let d;return function(p){return(d||(d=R(n)))(p||n)}})(),n.\u0275dir=S({type:n,features:[b]});let o=n;return o})();var L=(()=>{var e,i;let t=class t extends T{constructor(){super(...arguments);m(this,e);m(this,i);g(this,e,this.elementRendererConfig?.uiElementLoadingComponent),this.isLoading=y(()=>{let r=this.uiElementTemplate(),d=this.uiElementComponent(),E=this.componentRequiredInputs();return r?.status!=="loaded"||!d||!E}),g(this,i,D(()=>{this.isLoading()&&(this.viewContainerRef.clear(),c(this,e)&&this.viewContainerRef.createComponent(c(this,e)))}))}};e=new WeakMap,i=new WeakMap,t.\u0275fac=(()=>{let r;return function(E){return(r||(r=R(t)))(E||t)}})(),t.\u0275dir=S({type:t,features:[b]});let o=t;return o})();var ge=(()=>{var e,i,t,n,h;let r=class r extends T{constructor(){super(...arguments);m(this,e,C(Y));m(this,i,C($));m(this,t,C(L));m(this,n,y(()=>{if(c(this,t).isLoading()||c(this,i).isInfinite())return null;let p=this.uiElementTemplate(),u=this.uiElementComponent(),s=this.componentRequiredInputs(),j=U(this.uiElementTemplateId),x=u.ELEMENT_SYMBOL,v=this.requiredComponentSymbols();if(!this.hasCorrectComponentSymbol(u,v))return F(`${j}: Wrong element received: expect ${v.map(l=>String(l)).join("or ")} but got ${String(x)}`),null;this.viewContainerRef.clear();let I,a=this.getUIElementWrapper(x);if(a){a.setInput("uiElementTemplate",p.config);let l=a.instance.uiElementVCR();if(!l)return null;let f=l.createComponent(u);a.setInput("uiElementComponentRef",f),I=f}I=this.viewContainerRef.createComponent(u);for(let[l,f]of Object.entries(s))I.setInput(l,f);return I}));m(this,h,D(p=>{let u=this.componentInputsStream(),s=c(this,n).call(this),j=this.uiElementTemplate(),x=this.elementInterpolationContext();if(!u||!s||j?.status!=="loaded"||!x)return;s.location.nativeElement.setAttribute("elementTemplateId",U(this.uiElementTemplateId));let v=new B;p(()=>{v.next(),v.complete()});for(let[a,l]of Object.entries(u))this.checkInputExistsForComponent(s.componentType,a)?l.pipe(V(v)).subscribe(f=>{k(`[${this.uiElementTemplateId()}] Input stream for ${a}`),s.setInput(a,f)}):F(`Input ${a} does not exist for component ${s.instance.getElementType()}`);let{eventsHooks:I}=j.config;if(I)for(let[a,l]of Object.entries(I)){let f=s.instance[a];if(!f||!(f instanceof K))F(`Element ${s.instance.getElementType()} has no support for event "${a}"`);else{let G=x.pipe(q(1));f.subscribe(J=>{G.pipe(H(N=>this.interpolationService.interpolate({value:l,context:O(M({},N),{$eventOutput:J})}))).subscribe(N=>{k(`Output stream for ${this.uiElementTemplateId()}`),c(this,e).triggerActionHooks(N)})})}}}))}};e=new WeakMap,i=new WeakMap,t=new WeakMap,n=new WeakMap,h=new WeakMap,r.\u0275fac=(()=>{let p;return function(s){return(p||(p=R(r)))(s||r)}})(),r.\u0275dir=S({type:r,selectors:[["","djuiUIElementRenderer",""]],features:[W([{directive:$,inputs:["djuiUIElementRenderer","djuiUIElementRenderer"]},{directive:L,inputs:["djuiUIElementRenderer","djuiUIElementRenderer"]}]),b]});let o=r;return o})();export{ge as a};
