@let paginationConfig = paginationConfigOption();

@if (isErrorConfigOption()) {
  <span>Something went wrong fetching data</span>
} @else {
  <div class="table-container">
    @if (titleConfigOption(); as title) {
      <h3 class="table-header">{{ title }}</h3>
    }

    <p-table
      class="table-content"
      [columns]="columnsConfigOption()"
      [loading]="isLoadingConfigOption()"
      [resizableColumns]="resizableColumnsConfigOption()"
      [showGridlines]="gridLinesConfigOption()"
      [stripedRows]="stripesConfigOption()"
      [style.--data-row-height]="stylesConfigOption().fixedDataRowsHeight"
      [value]="rowsConfigOption()"
    >
      <ng-template #header columns let-columns>
        <tr class="headers-row">
          @for (col of columns; track $index) {
            <th pResizableColumn [pResizableColumnDisabled]="col.disableResizable">
              {{ col.label }}
            </th>
          }
        </tr>
      </ng-template>
      <ng-template #body let-columns="columns" let-rowData rows>
        <tr>
          @for (col of columns; track $index) {
            <td>
              @if (col.templateId) {
                @let curColData = rowData[col.id];
                @if (isUnknownRecord(curColData)) {
                  <ng-container
                    [configsOverride]="curColData"
                    [djuiUIElementRenderer]="col.templateId"
                    [requiredComponentSymbols]="tableCellSupportedTemplates"
                  ></ng-container>
                } @else {
                  <span
                    >Row data is of invalid format. Required an object that represent an options for
                    that template {{ col.templateId }} but received {{ curColData }}</span
                  >
                }
              } @else {
                {{ rowData[col.id] }}
              }
            </td>
          }
        </tr>
      </ng-template>
    </p-table>

    @if (shouldDisplayPagination()) {
      <p-paginator
        class="table-paginator"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords}"
        [first]="numberOfFirstRows()"
        [rows]="numberOfRowsToDisplayed()"
        [rowsPerPageOptions]="paginationConfig.pageSizes"
        [showCurrentPageReport]="true"
        [totalRecords]="paginationConfig.totalDataLength"
        (onPageChange)="pageChange($event)"
      />
    }
  </div>
}
