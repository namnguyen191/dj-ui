import{a as U,b as Ke,c as Xe,d as Ze,e as et}from"./chunk-AXTAIUVK.js";import{b as we}from"./chunk-HGQGSJNP.js";import{a as qe}from"./chunk-NHVOUDX7.js";import{a as xe,b as be}from"./chunk-OEMD7ULJ.js";import{a as ze,b as Ve}from"./chunk-K4CJI7RR.js";import{a as W}from"./chunk-A4LGCOQU.js";import{a as Je,b as Qe,c as Ge,e as $e,f as Ye}from"./chunk-AVQT7YHK.js";import{a as Be,b as Fe,c as Ne,d as Re,e as je,f as He,g as Ue,h as We}from"./chunk-53RS7JFF.js";import"./chunk-ZROLWDB4.js";import"./chunk-RFM5HJJR.js";import{c as Ae}from"./chunk-BXRE4WUR.js";import"./chunk-G3BAUKRR.js";import"./chunk-JRTCKBMB.js";import"./chunk-WEDA6QA5.js";import{D as H,p as De,t as Pe}from"./chunk-IMW6CZRX.js";import{b as Oe,d as ke,e as j}from"./chunk-OODSUOXW.js";import{d as Te,f as Ie}from"./chunk-HOXVOTVY.js";import{a as R,b as I,c as x}from"./chunk-F3GE6OJC.js";import"./chunk-ST6LUG46.js";import{c as ne}from"./chunk-AC577EVM.js";import"./chunk-FQHWX7XN.js";import"./chunk-ROZW5JAP.js";import"./chunk-LMQLNWY7.js";import"./chunk-I7O7BTAO.js";import{$a as r,$c as T,Ba as D,Bb as X,Ca as $,Cb as a,Cc as te,Eb as V,Ec as v,F as ce,Fc as N,Hb as Z,Kc as Se,Mb as s,Nb as l,Ob as u,Pb as C,Qb as _,Rb as fe,Sb as O,Sc as Le,Tb as h,Ub as c,V as G,Vb as ee,Vc as k,Wb as A,Zc as ie,_ as me,ac as B,bc as F,cb as Y,da as m,dc as g,ec as Ce,f as se,fb as K,hb as w,ib as P,jc as _e,kc as he,lc as ye,ma as M,mb as E,mc as Ee,na as S,nb as ue,oa as y,ob as ge,oc as ve,pa as L,qb as z,r as de,sc as Me,tb as p,wa as pe}from"./chunk-RVPXDSFJ.js";import{a as b,b as re,c as le}from"./chunk-Q7L6LLAK.js";var pt=["uiElementVCR"],tt=(()=>{class e{constructor(){this.uiElementTemplate=D.required(),this.uiElementInstance=D.required(),this.uiElementComponentRef=D.required(),this.uiElementVCR=P("uiElementVCR",{read:K})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275dir=ge({type:e,viewQuery:function(i,n){i&1&&B(n.uiElementVCR,pt,5,K),i&2&&F()},inputs:{uiElementTemplate:[1,"uiElementTemplate"],uiElementInstance:[1,"uiElementInstance"],uiElementComponentRef:[1,"uiElementComponentRef"]}})}}return e})();var it={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"circle",attrs:{cx:"23",cy:"24",r:"2"}},{elem:"path",attrs:{d:"M30.7769 23.4785A8.64 8.64 0 0023 18a8.64 8.64 0 00-7.7769 5.4785L15 24l.2231.5215A8.64 8.64 0 0023 30a8.64 8.64 0 007.7769-5.4785L31 24zM23 28a4 4 0 114-4A4.0045 4.0045 0 0123 28zM12.3989 20.8A6 6 0 1122 16H20a4 4 0 10-6.4 3.2z"}},{elem:"path",attrs:{d:"M29.3047,11.0439,26.9441,6.9561a1.9977,1.9977,0,0,0-2.3728-.8946l-2.4341.8233a11.0419,11.0419,0,0,0-1.312-.7583l-.5037-2.5186A2,2,0,0,0,18.36,2H13.64a2,2,0,0,0-1.9611,1.6079l-.5037,2.5186A10.9666,10.9666,0,0,0,9.8481,6.88L7.4287,6.0615a1.9977,1.9977,0,0,0-2.3728.8946L2.6953,11.0439a2.0006,2.0006,0,0,0,.4119,2.5025l1.9309,1.6968C5.021,15.4946,5,15.7446,5,16c0,.2578.01.5127.0278.7656l-1.9206,1.688a2.0006,2.0006,0,0,0-.4119,2.5025l2.3606,4.0878a1.9977,1.9977,0,0,0,2.3728.8946l2.4341-.8233a10.9736,10.9736,0,0,0,1.312.7583l.5037,2.5186A2,2,0,0,0,13.64,30H15V28H13.64l-.71-3.5508a9.0953,9.0953,0,0,1-2.6948-1.5713l-3.4468,1.166-2.36-4.0878L7.1528,17.561a8.9263,8.9263,0,0,1-.007-3.1279L4.4275,12.0439,6.7886,7.9561l3.4267,1.1591a9.0305,9.0305,0,0,1,2.7141-1.5644L13.64,4H18.36l.71,3.5508a9.0978,9.0978,0,0,1,2.6948,1.5713l3.4468-1.166,2.36,4.0878-2.7978,2.4522L26.0923,16l2.8-2.4536A2.0006,2.0006,0,0,0,29.3047,11.0439Z"}}],name:"settings--view",size:16};var gt=["*"],ft=(e,o,t,i,n,d,f,Q,dt,ct,mt)=>({"cds--contained-list--inset-rulers":e,"cds--contained-list--on-page":o,"cds--contained-list--disclosed":t,"cds--contained-list--sm":i,"cds--contained-list--md":n,"cds--contained-list--lg":d,"cds--contained-list--xl":f,"cds--layout--size-sm":Q,"cds--layout--size-md":dt,"cds--layout--size-lg":ct,"cds--layout--size-xl":mt});function Ct(e,o){if(e&1&&(C(0),g(1),_()),e&2){let t=c();r(),Ce(t.label)}}function _t(e,o){}function ht(e,o){if(e&1&&p(0,_t,0,0,"ng-template",6),e&2){let t=c();a("ngTemplateOutlet",t.label)}}function yt(e,o){}function Et(e,o){if(e&1&&(s(0,"div",7),p(1,yt,0,0,"ng-template",6),l()),e&2){let t=c();r(),a("ngTemplateOutlet",t.action)}}var vt=[[["","cdsContainedListItemButton",""],["","ibmContainedListItemButton",""]],"*"],Mt=["[cdsContainedListItemButton],[ibmContainedListItemButton]","*"],St=e=>({$implicit:e});function Lt(e,o){if(e&1){let t=O();C(0),s(1,"button",2),h("click",function(){M(t);let n=c();return S(n.onClick())}),A(2),l(),_()}if(e&2){let t=c();r(),a("disabled",t.disabled)}}function Tt(e,o){if(e&1&&(C(0),y(),u(1,"svg",6),_()),e&2){let t=c(3);r(),a("ibmIcon",t.icon)}}function It(e,o){}function xt(e,o){if(e&1&&p(0,It,0,0,"ng-template",7),e&2){let t=c(3);a("ngTemplateOutlet",t.icon)}}function bt(e,o){if(e&1&&(s(0,"div",5),p(1,Tt,2,1,"ng-container",0)(2,xt,1,1,null,0),l()),e&2){let t=c(2);r(),a("ngIf",!t.isTemplate(t.icon)),r(),a("ngIf",t.isTemplate(t.icon))}}function wt(e,o){if(e&1&&(C(0),s(1,"div",3),p(2,bt,3,2,"div",4),A(3,1),l(),_()),e&2){let t=c();r(2),a("ngIf",t.icon)}}function Ot(e,o){}function kt(e,o){if(e&1&&(s(0,"div",8),p(1,Ot,0,0,"ng-template",9),l()),e&2){let t=c();r(),a("ngTemplateOutlet",t.action)("ngTemplateOutletContext",ve(2,St,t.actionData))}}var oe=function(e){return e.Small="sm",e.Medium="md",e.Large="lg",e.ExtraLarge="xl",e}(oe||{}),ae=function(e){return e.OnPage="on-page",e.Disclosed="disclosed",e}(ae||{}),nt=(()=>{class e{constructor(){this.isInset=!1,this.kind=ae.OnPage,this.size=oe.Large,this.labelId=`contained-list-${e.count++}-header`,this.ContainedListSize=oe,this.ContainedListKind=ae}isTemplate(t){return t instanceof Y}}return e.count=0,e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=E({type:e,selectors:[["cds-contained-list"],["ibm-contained-list"]],inputs:{action:"action",isInset:"isInset",kind:"kind",label:"label",size:"size",labelId:"labelId"},standalone:!1,ngContentSelectors:gt,decls:8,vars:18,consts:[[1,"cds--contained-list",3,"ngClass"],[1,"cds--contained-list__header"],[1,"cds--contained-list__label",3,"id"],[4,"ngIf"],["class","cds--contained-list__action",4,"ngIf"],["role","list"],[3,"ngTemplateOutlet"],[1,"cds--contained-list__action"]],template:function(t,i){t&1&&(ee(),s(0,"div",0)(1,"div",1)(2,"div",2),p(3,Ct,2,1,"ng-container",3)(4,ht,1,1,null,3),l(),p(5,Et,2,1,"div",4),l(),s(6,"div",5),A(7),l()()),t&2&&(a("ngClass",Me(6,ft,[i.isInset,i.kind===i.ContainedListKind.OnPage,i.kind===i.ContainedListKind.Disclosed,i.size===i.ContainedListSize.Small,i.size===i.ContainedListSize.Medium,i.size===i.ContainedListSize.Large,i.size===i.ContainedListSize.ExtraLarge,i.size===i.ContainedListSize.Small,i.size===i.ContainedListSize.Medium,i.size===i.ContainedListSize.Large,i.size===i.ContainedListSize.ExtraLarge])),r(2),a("id",i.labelId),r(),a("ngIf",!i.isTemplate(i.label)),r(),a("ngIf",i.isTemplate(i.label)),r(),a("ngIf",i.action),r(),X("aria-labelledby",i.labelId))},dependencies:[Le,k,ie],encapsulation:2,changeDetection:0}),e})(),ot=(()=>{class e{constructor(){this.disabled=!1,this.click=new pe,this.itemClass=!0,this.role="listitem"}get itemClickableClass(){return this.clickable}get itemWithIconClass(){return!!this.icon}onClick(){this.click.emit()}isTemplate(t){return t instanceof Y}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=E({type:e,selectors:[["cds-contained-list-item"],["ibm-contained-list-item"]],hostVars:7,hostBindings:function(t,i){t&2&&(X("role",i.role),V("cds--contained-list-item",i.itemClass)("cds--contained-list-item--clickable",i.itemClickableClass)("cds--contained-list-item--with-icon",i.itemWithIconClass))},inputs:{action:"action",actionData:"actionData",disabled:"disabled",clickable:"clickable",icon:"icon"},outputs:{click:"click"},standalone:!1,ngContentSelectors:Mt,decls:3,vars:3,consts:[[4,"ngIf"],["class","cds--contained-list-item__action",4,"ngIf"],["type","button",1,"cds--contained-list-item__content",3,"click","disabled"],[1,"cds--contained-list-item__content"],["class","cds--contained-list-item__icon",4,"ngIf"],[1,"cds--contained-list-item__icon"],["size","16",3,"ibmIcon"],[3,"ngTemplateOutlet"],[1,"cds--contained-list-item__action"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,i){t&1&&(ee(vt),p(0,Lt,3,1,"ng-container",0)(1,wt,4,1,"ng-container",0)(2,kt,2,4,"div",1)),t&2&&(a("ngIf",i.clickable),r(),a("ngIf",!i.clickable),r(),a("ngIf",i.action))},dependencies:[k,ie,I],encapsulation:2,changeDetection:0}),e})(),at=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=ue({type:e}),e.\u0275inj=me({imports:[T,x]}),e})();var Pt=["contextMenu"],lt=(()=>{class e extends tt{#e;#i;#t;#n;constructor(){super(),this.#e=m(Se),this.#i=m(R),this.isContextMenuShow=w(!1),this._contextMenuEleSig=P("contextMenu",{read:$}),this.#t=t=>{this.#r(t)&&t.preventDefault()},this.#n=t=>{if(this.#s(t)){this.isContextMenuShow.set(!1);return}if(this.#l(t)&&!this.#o(t)){let i=v(this._contextMenuEleSig)?.nativeElement;if(!i){console.error("Something is wrong. Context menu element is not found!");return}let d=this.#a(t).getBoundingClientRect(),f=`${t.clientX-d.left}px`,Q=`${t.clientY-d.top}px`;i.style.setProperty("--pos-x",f),i.style.setProperty("--pos-y",Q),this.isContextMenuShow.set(!0)}},this.#i.registerAll([U,it])}ngOnInit(){this.#e.addEventListener("contextmenu",this.#t),this.#e.addEventListener("mouseup",this.#n,{passive:!0})}ngOnDestroy(){this.#e.removeEventListener("contextmenu",this.#t),this.#e.removeEventListener("mouseup",this.#n)}#a(t){let i=v(this.uiElementInstance)?.id;if(!i)throw new Error("Element instance ID has not been received");let n=t.target;for(;n.parentElement;){if(n.tagName.toLowerCase()==="gridster-item"&&n.id===i)return n;n=n.parentElement}return null}#o(t){let i=t.target;for(;i.parentElement;){if(i.id==="context-menu")return!0;i=i.parentElement}return!1}#r(t){return!!this.#a(t)}#l(t){return t.button===2&&this.#r(t)}#s(t){return t.button===0&&!this.#o(t)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=E({type:e,selectors:[["namnguyen191-dui-ui-element-builder-context-menu-wrapper"]],viewQuery:function(i,n){i&1&&B(n._contextMenuEleSig,Pt,5,$),i&2&&F()},features:[z],decls:28,vars:8,consts:[["uiElementVCR",""],["contextMenu",""],["id","context-menu","label","Control menu",1,"context-menu"],[3,"clickable"],["ibmContainedListItemButton",""],[1,"control-menu-item"],["cdsIcon","edit","size","16"],["cdsIcon","settings--view","size","16"],["cdsIcon","copy","size","16"],["cdsIcon","trash-can","size","16"]],template:function(i,n){i&1&&(fe(0,null,0),s(2,"cds-contained-list",2,1)(4,"cds-contained-list-item",3),C(5,4),s(6,"div",5)(7,"span"),g(8,"Edit"),l(),y(),u(9,"svg",6),l(),_(),l(),L(),s(10,"cds-contained-list-item",3),C(11,4),s(12,"div",5)(13,"span"),g(14,"View details"),l(),y(),u(15,"svg",7),l(),_(),l(),L(),s(16,"cds-contained-list-item",3),C(17,4),s(18,"div",5)(19,"span"),g(20,"Duplicate"),l(),y(),u(21,"svg",8),l(),_(),l(),L(),s(22,"cds-contained-list-item",3),C(23,4),s(24,"div",5)(25,"span"),g(26,"Delete"),l(),y(),u(27,"svg",9),l(),_(),l()()),i&2&&(r(2),V("hide",!n.isContextMenuShow())("show",n.isContextMenuShow()),r(2),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0))},dependencies:[T,at,nt,ot,x,I],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:absolute;top:var(--pos-y);left:var(--pos-x);width:10rem;background:var(--cds-layer-active-01);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]   .control-menu-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}}return e})();var zt={currentEditingTemplate:null},J=Qe({providedIn:"root"},Ye(zt),Ge(({currentEditingTemplate:e})=>({currentEditableFields:te(()=>{let o=e();if(!o)return null;let f=o,{id:t,createdAt:i,updatedAt:n}=f;return le(f,["id","createdAt","updatedAt"])}),currentUnEditableFields:te(()=>{let o=e();if(!o)return null;let{id:t,createdAt:i,updatedAt:n}=o;return{id:t,createdAt:i,updatedAt:n}})})),$e(e=>({setCurrentEditingTemplate:o=>{Je(e,{currentEditingTemplate:o})},updateCurrentEditingTemplate:o=>{Ke(e,t=>{let i=v(e.currentUnEditableFields);!t.currentEditingTemplate||!i||(t.currentEditingTemplate=b(b({},i),o))})}})));function Vt(e,o){e&1&&u(0,"cds-loading",5),e&2&&a("isActive",!0)}function At(e,o){if(e&1){let t=O();s(0,"ngx-monaco-editor",9),h("ngModelChange",function(n){M(t);let d=c();return S(d.codeChangeSubject.next(n))}),l()}if(e&2){let t=c(),i=ye(1);a("ngModel",i)("options",t.editorOptions)}}function Bt(e,o){e&1&&g(0," Error in JSON ")}function Ft(e,o){e&1&&g(0," Save your changes ")}function Nt(e,o){e&1&&u(0,"cds-loading",10)}var st=(()=>{class e extends Be{#e;#i;#t;constructor(){super(),this.#e=m(W),this.#i=m(J),this.loadingSig=this.#e.isPending,this.codeChangeSubject=new se,this.editorOptions={theme:"vs-dark",language:"json",wordWrap:"on"},this.codeSig=w(""),this.errorStateSig=w("noError"),this.#t="",this.codeChangeSubject.pipe(G({next:()=>this.errorStateSig.set("isPending")}),ce(500),G({next:t=>{this.codeSig.set(t),this.#o(t)?this.errorStateSig.set("noError"):this.errorStateSig.set("isError")}}),xe()).subscribe(),this.#n()}async updateLayoutTemplate(){let t=JSON.parse(v(this.codeSig));this.#i.updateCurrentEditingTemplate(t);let i=v(this.#i.currentEditingTemplate);if(!i){console.error("Edited template is missing from store");return}await this.#e.change(i),v(this.#e.error)||this.closeModal()}#n(){N(async()=>{let t=this.#i.currentEditableFields();if(!t)return;let i=JSON.stringify(t),n=await this.#a(i);this.#t=n,this.codeSig.set(n)})}async#a(t){return await et(t,{parser:"json",plugins:[Xe,Ze]})}#o(t){try{return JSON.parse(t),!0}catch(i){return console.log("Something went wrong:",i),!1}}closeModal(){this.codeSig.set(this.#t),super.closeModal()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=E({type:e,selectors:[["namnguyen191-layout-template-code-editor-modal"]],features:[z],decls:16,vars:7,consts:[["size","lg",3,"overlaySelected","open"],[3,"closeSelect","showCloseButton"],["cdsModalHeaderLabel",""],["cdsModalHeaderHeading",""],["cdsModalContent","",1,"modal-body"],[3,"isActive"],[1,"editor-container",3,"ngModel","options"],["cdsButton","primary",3,"click","disabled"],["size","sm",4,"ngIf"],[1,"editor-container",3,"ngModelChange","ngModel","options"],["size","sm"]],template:function(i,n){if(i&1){let d=O();_e(0)(1),s(2,"cds-modal",0),h("overlaySelected",function(){return M(d),S(n.closeModal())}),s(3,"cds-modal-header",1),h("closeSelect",function(){return M(d),S(n.closeModal())}),s(4,"h2",2),g(5,"Editor"),l(),s(6,"h3",3),g(7,"Edit your template in JSON"),l()(),s(8,"section",4),p(9,Vt,1,1,"cds-loading",5)(10,At,1,2,"ngx-monaco-editor",6),l(),s(11,"cds-modal-footer")(12,"button",7),h("click",function(){return M(d),S(n.updateLayoutTemplate())}),p(13,Bt,1,0)(14,Ft,1,0)(15,Nt,1,0,"cds-loading",8),l()()()}if(i&2){let d=n.errorStateSig();r();let f=he(n.codeSig());r(),a("open",n.open),r(),a("showCloseButton",!0),r(6),Z(n.loadingSig()||!f?9:10),r(3),a("disabled",d==="isError"||d==="isPending"),r(),Z(d==="isError"?13:14),r(2),a("ngIf",d==="isPending")}},dependencies:[T,k,We,Fe,Ne,Re,je,He,Ue,qe,H,De,Pe,Ve,ze,j,Oe,Ae],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]{height:70vh;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]   .editor-container[_ngcontent-%COMP%]{height:100%;flex:1}"],changeDetection:0})}}return e})();var Wi=(()=>{class e{#e;#i;#t;#n;#a;#o;constructor(){this.#e=m(Te),this.#i=m(Ie),this.#t=m(W),this.#n=m(J),this.#a=m(R),this.currentLayoutTemplateId=this.#e.snapshot.params.id,this.#o="editRawTemplate",this.isRawTemplateEditorModalOpenSig=be(this.#e.queryParams.pipe(de(t=>t[this.#o]==="true")),{initialValue:!1}),this.#a.registerAll([U]),this.#t.updateQuery({id:this.currentLayoutTemplateId}),this.#r()}toggleModal(t){this.#i.navigate([],{relativeTo:this.#e,queryParams:{[this.#o]:t?!0:null},queryParamsHandling:"merge"})}#r(){N(()=>{let t=this.#t.filteredLayoutTemplates()[0];t&&this.#n.setCurrentEditingTemplate(t)})}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=E({type:e,selectors:[["namnguyen191-edit-layout-page"]],features:[Ee([{provide:ne,useFactory:()=>{let t=m(ne,{skipSelf:!0});return re(b({},t),{uiElementExtraWrapperComponent:lt})}}])],decls:4,vars:3,consts:[[3,"layoutId"],["type","button",1,"edit-template-button",3,"click","kind"],["cdsIcon","edit","size","16",1,"cds--btn__icon"],[3,"close","open"]],template:function(i,n){i&1&&(u(0,"djui",0),s(1,"cds-icon-button",1),h("click",function(){return n.toggleModal(!0)}),y(),u(2,"svg",2),l(),L(),s(3,"namnguyen191-layout-template-code-editor-modal",3),h("close",function(){return n.toggleModal(!1)}),l()),i&2&&(a("layoutId",n.currentLayoutTemplateId),r(),a("kind","primary"),r(2),a("open",n.isRawTemplateEditorModalOpenSig()))},dependencies:[we,H,j,ke,x,I,st],styles:["[_nghost-%COMP%]{min-height:calc(100vh - 3rem);display:block;position:relative}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;opacity:.25;z-index:1000}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]:hover{opacity:1}[_nghost-%COMP%]     gridster-item{background-color:#0003}"],changeDetection:0})}}return e})();export{Wi as EditLayoutPageComponent};
