import{a as z,c as G}from"./chunk-AG2UT2NW.js";import{e as k,f as Y}from"./chunk-7PVQWRKD.js";import{a as A}from"./chunk-JQNNOW5S.js";import{a as H}from"./chunk-OXQFDIO2.js";import{a as B}from"./chunk-5EH4PHE6.js";import{a as $}from"./chunk-ONUWX4Z3.js";import{a as L}from"./chunk-5SLFWW7S.js";import{ba as v}from"./chunk-PAE2UDOJ.js";import{b as q}from"./chunk-EWAYVCWY.js";import{a as R}from"./chunk-7JQNGYFA.js";import{v as w}from"./chunk-4YZRLV7F.js";import{Fb as I,Gb as M,Hb as j,Hc as f,Ib as U,Ic as E,Lc as F,Nc as O,Oc as _,Tb as N,a as T,e as t,f as o,g as a,ia as h,jb as b,qc as P,rc as D,y as C}from"./chunk-UJ7YJEPZ.js";var V=()=>({}),p="dj-ui-schemas",x={[B]:`${p}/AppEditPrimeNgSimpleTableUIESchema.json`,[H]:`${p}/AppEditPrimeNgSimpleTextUIESchema.json`,[R]:`${p}/AppEditPrimeNgSimpleImageUIESchema.json`,[A]:`${p}/AppEditSimpleGridUIESchema.json`,[L]:`${p}/AppEditPrimeNgImagesCarouselUIESchema.json`,[$]:`${p}/AppEditPrimeNgCardUIESchema.json`},me=(()=>{var r,u,l,c,g,s;let m=class m{constructor(){o(this,r);o(this,u);o(this,l);o(this,c);o(this,g);o(this,s);a(this,r,h(k)),a(this,u,h(w)),a(this,l,h(v)),a(this,c,h(q)),this.query=_.required(),this.visible=_.required(),this.editCancel=O(),this.loadingSig=E(()=>t(this,r).isPending()||this.jsonSchemaConfigResource.isLoading()),this.jsonSchemaConfigResource=F({params:()=>({uiElementType:t(this,s).call(this)?.type}),loader:async({params:e})=>{let{uiElementType:i}=e;return i?{schema:await C(t(this,c).get(x[i])),schemaId:i}:void 0}}),a(this,g,E(()=>{let e=f(this.query);return t(this,r).entities().filter(Y(e))})),a(this,s,E(()=>{let e=t(this,g).call(this);return e.length<=0?null:(e.length>1&&console.warn(`Multiple UIE templates with the same ID of ${f(this.query).id} detected. This could be an error. The first one will be selected for editing`),e[0])})),this.currentEditableFieldsSig=E(()=>{let e=t(this,s).call(this);if(!e)return null;let{name:i,description:n,remoteResourceIds:d,stateSubscription:S,options:J,eventsHooks:Q}=e;return{name:i,description:n,remoteResourceIds:d,stateSubscription:S,options:J,eventsHooks:Q}})}async updateUIElementTemplate(e){let i=JSON.parse(e),n=f(t(this,s));if(!n)return;let d=T(T({},n),i);await t(this,r).change(d),f(t(this,r).error)?t(this,l).add({severity:"error",summary:"Template saved failure",detail:"Your UIE template could not be saved, please try again later or refresh the page",life:9999}):(t(this,l).add({severity:"success",summary:"Template saved successfully",detail:"Your UIE template has been successfully saved",life:3e3}),t(this,u).updateTemplate(d))}};r=new WeakMap,u=new WeakMap,l=new WeakMap,c=new WeakMap,g=new WeakMap,s=new WeakMap,m.\u0275fac=function(i){return new(i||m)},m.\u0275cmp=b({type:m,selectors:[["prime-ng-playground-builder-feat-raw-ui-element-template-editor-modal"]],inputs:{query:[1,"query"],visible:[1,"visible"]},outputs:{editCancel:"editCancel"},features:[P([v])],decls:2,vars:5,consts:[[3,"editCancel","save","isLoading","isOpen","jsonObj","schemaConfig"],[1,"toast"]],template:function(i,n){i&1&&(M(0,"prime-ng-playground-builder-feat-json-editor-modal",0),N("editCancel",function(){return n.editCancel.emit()})("save",function(S){return n.updateUIElementTemplate(S)}),j(),U(1,"p-toast",1)),i&2&&I("isLoading",n.loadingSig())("isOpen",n.visible())("jsonObj",n.currentEditableFieldsSig()??D(4,V))("schemaConfig",n.jsonSchemaConfigResource.value())},dependencies:[G,z],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]     .p-dialog-mask{z-index:9998!important}[_nghost-%COMP%]   .toast[_ngcontent-%COMP%]{z-index:10000}"],changeDetection:0});let y=m;return y})();export{me as a};
