import{b as xe}from"./chunk-ROZW5JAP.js";import{e as U,f as ce,g as de}from"./chunk-LMQLNWY7.js";import{a as me,b as k}from"./chunk-I7O7BTAO.js";import{B as z,D as j,Fc as le,J as oe,K as ae,L as se,N as Bt,P as ne,R as mt,S as ie,T as x,U as fe,V as ct,Z as v,aa as V,b as ee,c as Wt,da as S,f as re,g as C,hb as ue,i as Nt,ia as pe,ja as L,l,q as $t,qa as dt,r as T,s as P,x as Z}from"./chunk-RVPXDSFJ.js";import{a as b,b as H}from"./chunk-Q7L6LLAK.js";var ti=new V("CORE_LAYOUT_CONFIG");var si=t=>{let r=ue(void 0);return le(e=>{let a=t().subscribe(s=>r.set(s));e(()=>{a.unsubscribe()})}),r};var ni=t=>(e,o)=>o(e).pipe(oe(t));var eo=Object.prototype;function ro(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||eo;return t===e}var xt=ro;function oo(t,r){return function(e){return t(r(e))}}var he=oo;var ao=he(Object.keys,Object),ge=ao;var so=Object.prototype,no=so.hasOwnProperty;function io(t){if(!xt(t))return ge(t);var r=[];for(var e in Object(t))no.call(t,e)&&e!="constructor"&&r.push(e);return r}var ht=io;var fo=typeof global=="object"&&global&&global.Object===Object&&global,gt=fo;var po=typeof self=="object"&&self&&self.Object===Object&&self,uo=gt||po||Function("return this")(),g=uo;var lo=g.Symbol,O=lo;var ye=Object.prototype,mo=ye.hasOwnProperty,co=ye.toString,it=O?O.toStringTag:void 0;function xo(t){var r=mo.call(t,it),e=t[it];try{t[it]=void 0;var o=!0}catch{}var a=co.call(t);return o&&(r?t[it]=e:delete t[it]),a}var be=xo;var ho=Object.prototype,go=ho.toString;function yo(t){return go.call(t)}var ve=yo;var bo="[object Null]",vo="[object Undefined]",Se=O?O.toStringTag:void 0;function So(t){return t==null?t===void 0?vo:bo:Se&&Se in Object(t)?be(t):ve(t)}var A=So;function wo(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var K=wo;var Ro="[object AsyncFunction]",_o="[object Function]",Oo="[object GeneratorFunction]",Io="[object Proxy]";function To(t){if(!K(t))return!1;var r=A(t);return r==_o||r==Oo||r==Ro||r==Io}var yt=To;var Ao=g["__core-js_shared__"],bt=Ao;var we=function(){var t=/[^.]+$/.exec(bt&&bt.keys&&bt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Eo(t){return!!we&&we in t}var Re=Eo;var Co=Function.prototype,Po=Co.toString;function jo(t){if(t!=null){try{return Po.call(t)}catch{}try{return t+""}catch{}}return""}var F=jo;var Lo=/[\\^$.*+?()[\]{}|]/g,Fo=/^\[object .+?Constructor\]$/,Mo=Function.prototype,ko=Object.prototype,qo=Mo.toString,Wo=ko.hasOwnProperty,No=RegExp("^"+qo.call(Wo).replace(Lo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $o(t){if(!K(t)||Re(t))return!1;var r=yt(t)?No:Fo;return r.test(F(t))}var _e=$o;function Bo(t,r){return t?.[r]}var Oe=Bo;function Do(t,r){var e=Oe(t,r);return _e(e)?e:void 0}var w=Do;var Go=w(g,"DataView"),vt=Go;var Ho=w(g,"Map"),q=Ho;var zo=w(g,"Promise"),St=zo;var Uo=w(g,"Set"),wt=Uo;var Ko=w(g,"WeakMap"),Rt=Ko;var Ie="[object Map]",Jo="[object Object]",Te="[object Promise]",Ae="[object Set]",Ee="[object WeakMap]",Ce="[object DataView]",Xo=F(vt),Yo=F(q),Zo=F(St),Vo=F(wt),Qo=F(Rt),J=A;(vt&&J(new vt(new ArrayBuffer(1)))!=Ce||q&&J(new q)!=Ie||St&&J(St.resolve())!=Te||wt&&J(new wt)!=Ae||Rt&&J(new Rt)!=Ee)&&(J=function(t){var r=A(t),e=r==Jo?t.constructor:void 0,o=e?F(e):"";if(o)switch(o){case Xo:return Ce;case Yo:return Ie;case Zo:return Te;case Vo:return Ae;case Qo:return Ee}return r});var ft=J;function ta(t){return t!=null&&typeof t=="object"}var E=ta;var ea="[object Arguments]";function ra(t){return E(t)&&A(t)==ea}var Dt=ra;var Pe=Object.prototype,oa=Pe.hasOwnProperty,aa=Pe.propertyIsEnumerable,sa=Dt(function(){return arguments}())?Dt:function(t){return E(t)&&oa.call(t,"callee")&&!aa.call(t,"callee")},_t=sa;var na=Array.isArray,y=na;var ia=9007199254740991;function fa(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ia}var Ot=fa;function pa(t){return t!=null&&Ot(t.length)&&!yt(t)}var It=pa;function ua(){return!1}var je=ua;var Me=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Le=Me&&typeof module=="object"&&module&&!module.nodeType&&module,la=Le&&Le.exports===Me,Fe=la?g.Buffer:void 0,ma=Fe?Fe.isBuffer:void 0,ca=ma||je,X=ca;var da="[object Arguments]",xa="[object Array]",ha="[object Boolean]",ga="[object Date]",ya="[object Error]",ba="[object Function]",va="[object Map]",Sa="[object Number]",wa="[object Object]",Ra="[object RegExp]",_a="[object Set]",Oa="[object String]",Ia="[object WeakMap]",Ta="[object ArrayBuffer]",Aa="[object DataView]",Ea="[object Float32Array]",Ca="[object Float64Array]",Pa="[object Int8Array]",ja="[object Int16Array]",La="[object Int32Array]",Fa="[object Uint8Array]",Ma="[object Uint8ClampedArray]",ka="[object Uint16Array]",qa="[object Uint32Array]",c={};c[Ea]=c[Ca]=c[Pa]=c[ja]=c[La]=c[Fa]=c[Ma]=c[ka]=c[qa]=!0;c[da]=c[xa]=c[Ta]=c[ha]=c[Aa]=c[ga]=c[ya]=c[ba]=c[va]=c[Sa]=c[wa]=c[Ra]=c[_a]=c[Oa]=c[Ia]=!1;function Wa(t){return E(t)&&Ot(t.length)&&!!c[A(t)]}var ke=Wa;function Na(t){return function(r){return t(r)}}var qe=Na;var We=typeof exports=="object"&&exports&&!exports.nodeType&&exports,pt=We&&typeof module=="object"&&module&&!module.nodeType&&module,$a=pt&&pt.exports===We,Gt=$a&&gt.process,Ba=function(){try{var t=pt&&pt.require&&pt.require("util").types;return t||Gt&&Gt.binding&&Gt.binding("util")}catch{}}(),Ht=Ba;var Ne=Ht&&Ht.isTypedArray,Da=Ne?qe(Ne):ke,Q=Da;var Ga="[object Map]",Ha="[object Set]",za=Object.prototype,Ua=za.hasOwnProperty;function Ka(t){if(t==null)return!0;if(It(t)&&(y(t)||typeof t=="string"||typeof t.splice=="function"||X(t)||Q(t)||_t(t)))return!t.length;var r=ft(t);if(r==Ga||r==Ha)return!t.size;if(xt(t))return!ht(t).length;for(var e in t)if(Ua.call(t,e))return!1;return!0}var Tt=Ka;var Ja="[object Symbol]";function Xa(t){return typeof t=="symbol"||E(t)&&A(t)==Ja}var tt=Xa;function Ya(t,r){for(var e=-1,o=t==null?0:t.length,a=Array(o);++e<o;)a[e]=r(t[e],e,t);return a}var $e=Ya;var Za=1/0,Be=O?O.prototype:void 0,De=Be?Be.toString:void 0;function Ge(t){if(typeof t=="string")return t;if(y(t))return $e(t,Ge)+"";if(tt(t))return De?De.call(t):"";var r=t+"";return r=="0"&&1/t==-Za?"-0":r}var He=Ge;var Va=function(){try{var t=w(Object,"defineProperty");return t({},"",{}),t}catch{}}(),zt=Va;var Qa=9007199254740991,ts=/^(?:0|[1-9]\d*)$/;function es(t,r){var e=typeof t;return r=r??Qa,!!r&&(e=="number"||e!="symbol"&&ts.test(t))&&t>-1&&t%1==0&&t<r}var At=es;function rs(t,r,e){r=="__proto__"&&zt?zt(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}var ze=rs;function os(t,r){return t===r||t!==t&&r!==r}var et=os;var as=Object.prototype,ss=as.hasOwnProperty;function ns(t,r,e){var o=t[r];(!(ss.call(t,r)&&et(o,e))||e===void 0&&!(r in t))&&ze(t,r,e)}var Ue=ns;function is(t,r){for(var e=-1,o=Array(t);++e<t;)o[e]=r(e);return o}var Ke=is;var fs=Object.prototype,ps=fs.hasOwnProperty;function us(t,r){var e=y(t),o=!e&&_t(t),a=!e&&!o&&X(t),s=!e&&!o&&!a&&Q(t),n=e||o||a||s,i=n?Ke(t.length,String):[],f=i.length;for(var p in t)(r||ps.call(t,p))&&!(n&&(p=="length"||a&&(p=="offset"||p=="parent")||s&&(p=="buffer"||p=="byteLength"||p=="byteOffset")||At(p,f)))&&i.push(p);return i}var Je=us;function ls(t){return It(t)?Je(t):ht(t)}var Xe=ls;var ms=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cs=/^\w*$/;function ds(t,r){if(y(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||tt(t)?!0:cs.test(t)||!ms.test(t)||r!=null&&t in Object(r)}var Ye=ds;var xs=w(Object,"create"),M=xs;function hs(){this.__data__=M?M(null):{},this.size=0}var Ze=hs;function gs(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var Ve=gs;var ys="__lodash_hash_undefined__",bs=Object.prototype,vs=bs.hasOwnProperty;function Ss(t){var r=this.__data__;if(M){var e=r[t];return e===ys?void 0:e}return vs.call(r,t)?r[t]:void 0}var Qe=Ss;var ws=Object.prototype,Rs=ws.hasOwnProperty;function _s(t){var r=this.__data__;return M?r[t]!==void 0:Rs.call(r,t)}var tr=_s;var Os="__lodash_hash_undefined__";function Is(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=M&&r===void 0?Os:r,this}var er=Is;function rt(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var o=t[r];this.set(o[0],o[1])}}rt.prototype.clear=Ze;rt.prototype.delete=Ve;rt.prototype.get=Qe;rt.prototype.has=tr;rt.prototype.set=er;var Ut=rt;function Ts(){this.__data__=[],this.size=0}var rr=Ts;function As(t,r){for(var e=t.length;e--;)if(et(t[e][0],r))return e;return-1}var W=As;var Es=Array.prototype,Cs=Es.splice;function Ps(t){var r=this.__data__,e=W(r,t);if(e<0)return!1;var o=r.length-1;return e==o?r.pop():Cs.call(r,e,1),--this.size,!0}var or=Ps;function js(t){var r=this.__data__,e=W(r,t);return e<0?void 0:r[e][1]}var ar=js;function Ls(t){return W(this.__data__,t)>-1}var sr=Ls;function Fs(t,r){var e=this.__data__,o=W(e,t);return o<0?(++this.size,e.push([t,r])):e[o][1]=r,this}var nr=Fs;function ot(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var o=t[r];this.set(o[0],o[1])}}ot.prototype.clear=rr;ot.prototype.delete=or;ot.prototype.get=ar;ot.prototype.has=sr;ot.prototype.set=nr;var N=ot;function Ms(){this.size=0,this.__data__={hash:new Ut,map:new(q||N),string:new Ut}}var ir=Ms;function ks(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}var fr=ks;function qs(t,r){var e=t.__data__;return fr(r)?e[typeof r=="string"?"string":"hash"]:e.map}var $=qs;function Ws(t){var r=$(this,t).delete(t);return this.size-=r?1:0,r}var pr=Ws;function Ns(t){return $(this,t).get(t)}var ur=Ns;function $s(t){return $(this,t).has(t)}var lr=$s;function Bs(t,r){var e=$(this,t),o=e.size;return e.set(t,r),this.size+=e.size==o?0:1,this}var mr=Bs;function at(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var o=t[r];this.set(o[0],o[1])}}at.prototype.clear=ir;at.prototype.delete=pr;at.prototype.get=ur;at.prototype.has=lr;at.prototype.set=mr;var Y=at;var Ds="Expected a function";function Kt(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(Ds);var e=function(){var o=arguments,a=r?r.apply(this,o):o[0],s=e.cache;if(s.has(a))return s.get(a);var n=t.apply(this,o);return e.cache=s.set(a,n)||s,n};return e.cache=new(Kt.Cache||Y),e}Kt.Cache=Y;var cr=Kt;var Gs=500;function Hs(t){var r=cr(t,function(o){return e.size===Gs&&e.clear(),o}),e=r.cache;return r}var dr=Hs;var zs=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Us=/\\(\\)?/g,Ks=dr(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(zs,function(e,o,a,s){r.push(a?s.replace(Us,"$1"):o||e)}),r}),xr=Ks;function Js(t){return t==null?"":He(t)}var hr=Js;function Xs(t,r){return y(t)?t:Ye(t,r)?[t]:xr(hr(t))}var Et=Xs;var Ys=1/0;function Zs(t){if(typeof t=="string"||tt(t))return t;var r=t+"";return r=="0"&&1/t==-Ys?"-0":r}var Ct=Zs;function Vs(t,r){r=Et(r,t);for(var e=0,o=r.length;t!=null&&e<o;)t=t[Ct(r[e++])];return e&&e==o?t:void 0}var gr=Vs;function Qs(t,r,e){var o=t==null?void 0:gr(t,r);return o===void 0?e:o}var Jt=Qs;function tn(t,r){for(var e=-1,o=r.length,a=t.length;++e<o;)t[a+e]=r[e];return t}var yr=tn;function en(){this.__data__=new N,this.size=0}var br=en;function rn(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}var vr=rn;function on(t){return this.__data__.get(t)}var Sr=on;function an(t){return this.__data__.has(t)}var wr=an;var sn=200;function nn(t,r){var e=this.__data__;if(e instanceof N){var o=e.__data__;if(!q||o.length<sn-1)return o.push([t,r]),this.size=++e.size,this;e=this.__data__=new Y(o)}return e.set(t,r),this.size=e.size,this}var Rr=nn;function st(t){var r=this.__data__=new N(t);this.size=r.size}st.prototype.clear=br;st.prototype.delete=vr;st.prototype.get=Sr;st.prototype.has=wr;st.prototype.set=Rr;var Pt=st;function fn(t,r){for(var e=-1,o=t==null?0:t.length,a=0,s=[];++e<o;){var n=t[e];r(n,e,t)&&(s[a++]=n)}return s}var _r=fn;function pn(){return[]}var Or=pn;var un=Object.prototype,ln=un.propertyIsEnumerable,Ir=Object.getOwnPropertySymbols,mn=Ir?function(t){return t==null?[]:(t=Object(t),_r(Ir(t),function(r){return ln.call(t,r)}))}:Or,Tr=mn;function cn(t,r,e){var o=r(t);return y(t)?o:yr(o,e(t))}var Ar=cn;function dn(t){return Ar(t,Xe,Tr)}var Xt=dn;var xn=g.Uint8Array,Yt=xn;var hn="__lodash_hash_undefined__";function gn(t){return this.__data__.set(t,hn),this}var Er=gn;function yn(t){return this.__data__.has(t)}var Cr=yn;function jt(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new Y;++r<e;)this.add(t[r])}jt.prototype.add=jt.prototype.push=Er;jt.prototype.has=Cr;var Pr=jt;function bn(t,r){for(var e=-1,o=t==null?0:t.length;++e<o;)if(r(t[e],e,t))return!0;return!1}var jr=bn;function vn(t,r){return t.has(r)}var Lr=vn;var Sn=1,wn=2;function Rn(t,r,e,o,a,s){var n=e&Sn,i=t.length,f=r.length;if(i!=f&&!(n&&f>i))return!1;var p=s.get(t),u=s.get(r);if(p&&u)return p==r&&u==t;var d=-1,h=!0,I=e&wn?new Pr:void 0;for(s.set(t,r),s.set(r,t);++d<i;){var R=t[d],_=r[d];if(o)var m=n?o(_,R,d,r,t,s):o(R,_,d,t,r,s);if(m!==void 0){if(m)continue;h=!1;break}if(I){if(!jr(r,function(D,G){if(!Lr(I,G)&&(R===D||a(R,D,e,o,s)))return I.push(G)})){h=!1;break}}else if(!(R===_||a(R,_,e,o,s))){h=!1;break}}return s.delete(t),s.delete(r),h}var Lt=Rn;function _n(t){var r=-1,e=Array(t.size);return t.forEach(function(o,a){e[++r]=[a,o]}),e}var Fr=_n;function On(t){var r=-1,e=Array(t.size);return t.forEach(function(o){e[++r]=o}),e}var Mr=On;var In=1,Tn=2,An="[object Boolean]",En="[object Date]",Cn="[object Error]",Pn="[object Map]",jn="[object Number]",Ln="[object RegExp]",Fn="[object Set]",Mn="[object String]",kn="[object Symbol]",qn="[object ArrayBuffer]",Wn="[object DataView]",kr=O?O.prototype:void 0,Zt=kr?kr.valueOf:void 0;function Nn(t,r,e,o,a,s,n){switch(e){case Wn:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case qn:return!(t.byteLength!=r.byteLength||!s(new Yt(t),new Yt(r)));case An:case En:case jn:return et(+t,+r);case Cn:return t.name==r.name&&t.message==r.message;case Ln:case Mn:return t==r+"";case Pn:var i=Fr;case Fn:var f=o&In;if(i||(i=Mr),t.size!=r.size&&!f)return!1;var p=n.get(t);if(p)return p==r;o|=Tn,n.set(t,r);var u=Lt(i(t),i(r),o,a,s,n);return n.delete(t),u;case kn:if(Zt)return Zt.call(t)==Zt.call(r)}return!1}var qr=Nn;var $n=1,Bn=Object.prototype,Dn=Bn.hasOwnProperty;function Gn(t,r,e,o,a,s){var n=e&$n,i=Xt(t),f=i.length,p=Xt(r),u=p.length;if(f!=u&&!n)return!1;for(var d=f;d--;){var h=i[d];if(!(n?h in r:Dn.call(r,h)))return!1}var I=s.get(t),R=s.get(r);if(I&&R)return I==r&&R==t;var _=!0;s.set(t,r),s.set(r,t);for(var m=n;++d<f;){h=i[d];var D=t[h],G=r[h];if(o)var te=n?o(G,D,h,r,t,s):o(D,G,h,t,r,s);if(!(te===void 0?D===G||a(D,G,e,o,s):te)){_=!1;break}m||(m=h=="constructor")}if(_&&!m){var ut=t.constructor,lt=r.constructor;ut!=lt&&"constructor"in t&&"constructor"in r&&!(typeof ut=="function"&&ut instanceof ut&&typeof lt=="function"&&lt instanceof lt)&&(_=!1)}return s.delete(t),s.delete(r),_}var Wr=Gn;var Hn=1,Nr="[object Arguments]",$r="[object Array]",Ft="[object Object]",zn=Object.prototype,Br=zn.hasOwnProperty;function Un(t,r,e,o,a,s){var n=y(t),i=y(r),f=n?$r:ft(t),p=i?$r:ft(r);f=f==Nr?Ft:f,p=p==Nr?Ft:p;var u=f==Ft,d=p==Ft,h=f==p;if(h&&X(t)){if(!X(r))return!1;n=!0,u=!1}if(h&&!u)return s||(s=new Pt),n||Q(t)?Lt(t,r,e,o,a,s):qr(t,r,f,e,o,a,s);if(!(e&Hn)){var I=u&&Br.call(t,"__wrapped__"),R=d&&Br.call(r,"__wrapped__");if(I||R){var _=I?t.value():t,m=R?r.value():r;return s||(s=new Pt),a(_,m,e,o,s)}}return h?(s||(s=new Pt),Wr(t,r,e,o,a,s)):!1}var Dr=Un;function Gr(t,r,e,o,a){return t===r?!0:t==null||r==null||!E(t)&&!E(r)?t!==t&&r!==r:Dr(t,r,e,o,Gr,a)}var Hr=Gr;function Kn(t,r){return Hr(t,r)}var Vt=Kn;function Jn(t,r,e,o){if(!K(t))return t;r=Et(r,t);for(var a=-1,s=r.length,n=s-1,i=t;i!=null&&++a<s;){var f=Ct(r[a]),p=e;if(f==="__proto__"||f==="constructor"||f==="prototype")return t;if(a!=n){var u=i[f];p=o?o(u,f,i):void 0,p===void 0&&(p=K(u)?u:At(r[a+1])?[]:{})}Ue(i,f,p),i=i[f]}return t}var zr=Jn;function Xn(t,r,e){return t==null?t:zr(t,r,e)}var Qt=Xn;var Im=k.object({type:k.string(),payload:k.any().optional()}),Ur=(()=>{class t{#t={};registerHook(e){let{hookId:o,handler:a,payloadParser:s}=e;this.#t[o]&&console.warn(`The hook ${o} has already existed. Registering it again will override it`),this.#t[o]={handler:a,payloadParser:s}}registerHooks(e){Object.entries(e).forEach(([o,{handler:a,payloadParser:s}])=>{this.registerHook({hookId:o,handler:a,payloadParser:s})})}triggerActionHook(e){let o=this.#t[e.type]?.handler;if(!o){console.warn(`No handler for hook ${e.type}`);return}let a=this.#t[e.type]?.payloadParser;if(a)try{a.parse(e.payload)}catch(s){s instanceof me?console.warn(`Receiving: ${JSON.stringify(e)} which is an invalid hook: ${s.message}`):console.warn(`An unknown error has occured while trying to parse ${JSON.stringify(e)}. Nothing will be be triggered`);return}o(e.payload)}triggerActionHooks(e){e.forEach(o=>{this.triggerActionHook(o)})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Mt=/^(<\${)(.*)(}\$>)$/,Em=new V("CORE_CONFIG"),Kr=new V("CREATE_JS_RUNNER_WORKER"),Jr=new V("MAX_WORKER_POOl");var Yn="Interpolation failed";function Xr(t){return!!(t&&typeof t=="object"&&"error"in t&&t.error===Yn)}var $m=k.string().regex(Mt),kt=(()=>{class t{#t;#e;#r;constructor(){this.MAX_WORKER_POOl=S(Jr,{optional:!0})??4,this.#t=[],this.#e=new C(null);try{this.#r=S(Kr);for(let e=0;e<this.MAX_WORKER_POOl;e++){let o=this.#o();this.#t.push({id:e,isBusy:!1,worker:o})}}catch{throw new Error("You will need to provide a function to create a worker through the CREATE_JS_RUNNER_WORKER token. Please refer to the docs on how to do this")}}interpolate(e){let{value:o,context:a}=e;return!o||Tt(o)?l(o):typeof o=="string"?this.#f({stringContent:o,context:a}):typeof o=="object"?Array.isArray(o)?this.#u({array:o,context:a}):this.#p({object:o,context:a}):l(o)}checkForInterpolation(e){return!e||Tt(e)?!1:typeof e=="string"?this.#s(e)!==null:typeof e=="object"?Array.isArray(e)?this.#l(e):this.#m(e):!1}#a(e){let{rawJs:o,context:a}=e,s=Math.random().toString(),n={type:"INTERPOLATE",payload:{id:s,rawJs:o,context:a}};return new Wt(f=>{let p,u=!1,d=5e3,I=d+5e3,_=this.#c(n).pipe($t({each:d,with:()=>{let m="Taking too long to find an available worker";throw U(m),new Error(m)}}),x(m=>(p=m,this.#e.asObservable())),z(m=>m?.id===s),$t({each:I,with:()=>{this.#i(p);let m=`Timeout trying to interpolate rawJs because it is running for too long: ${o}`;throw this.#n(p),U(m),new Error(m)}}),T(m=>{if(Xr(m.result))throw new Error("Failed to interpolate rawJs");return m.result}),ct(()=>{this.#i(p),this.#d(p),u=!0})).subscribe({next:m=>{f.next(m),f.complete()},error:m=>{f.error(m),f.complete()}});return()=>{p!==void 0&&!u&&this.#n(p),_.unsubscribe()}})}#s(e){return Mt.test(e)?Mt.exec(e)?.[2]:null}#f(e){let{context:o,stringContent:a}=e,s=a.trim(),n=this.#s(s);return n?this.#a({rawJs:n,context:o}):l(a)}#p(e){let{context:o,object:a}=e,s={};for(let[n,i]of Object.entries(a))s[n]=this.interpolate({value:i,context:o});return Z(s)}#u(e){let{context:o,array:a}=e,s=[];for(let n of a)s.push(this.interpolate({value:n,context:o}));return Z(s)}#l(e){let o=!1;for(let a=0;a<e.length;a++){let s=e[a];o=o||this.checkForInterpolation(s)}return o}#m(e){let o=!1;for(let a of Object.values(e))o=o||this.checkForInterpolation(a);return o}#c(e){let o;return new Wt(s=>{let n=()=>{for(let i of this.#t)if(!i.isBusy){i.isBusy=!0,i.worker.postMessage(e),s.next(i.id),s.complete();return}o=window.setTimeout(()=>{n()},100)};return n(),()=>{o!==void 0&&window.clearTimeout(o)}})}#n(e){let o=this.#t.find(a=>a.id===e);o?(o.worker.terminate(),o.worker=this.#o(),o.isBusy=!1):U(`Cannot find worker with ID ${e}`)}#d(e){let o=this.#t.find(a=>a.id===e);o?o.isBusy=!1:U(`Cannot find worker with ID ${e}`)}#i(e){if(e===void 0)throw Error("Worker id is empty")}#o(){let e=this.#r();return e.onmessage=o=>{this.#e.next(o.data)},e}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Yr=(()=>{class t{#t={};registerFetcher(e,o){this.#t[e]&&ce(`Fetcher with id ${e} already exists. Registering it again will override it`),this.#t[e]=o}registerFetchers(e){for(let[o,a]of Object.entries(e))this.registerFetcher(o,a)}getFetcher(e){let o=this.#t[e];if(!o){let a=`Fetcher with id ${e} does not exists. Please register it first`;throw U(a),new Error(a)}return o}fetchData(e,o){return this.getFetcher(e)(o)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ym=k.enum(["global","local","layout"]);var B=t=>{let{watchedScopes:r,variables:e}=t,{local:o,layout:a,global:s}=r,n=S(Zn),i=S(kt),f=o?n.getLocalStateByPaths(o):l({}),p=s?n.getGlobalStateByPaths(s):l({}),u=a?n.getLayoutStateByPaths(a):l({});return P({global:p,local:f,layout:u}).pipe(x(d=>e?i.interpolate({value:e,context:{state:d}}).pipe(T(h=>H(b({},d),{variables:h}))):l(b({},d))))},Zn=(()=>{class t{#t=new C({});#e=new C({});#r=new C({});getGlobalState(){return this.#t.asObservable()}getGlobalStateByPaths(e){return this.#t.asObservable().pipe(this.watchStatePaths(e))}getLocalState(){return this.#r.asObservable()}getLocalStateByPaths(e){return this.#r.asObservable().pipe(this.watchStatePaths(e))}getLayoutState(){return this.#e.asObservable()}getLayoutStateByPaths(e){return this.#e.asObservable().pipe(this.watchStatePaths(e))}addToState(e){let{scope:o,data:a}=e;switch(o){case"global":{let s=this.#t.getValue();this.#t.next(b(b({},s),a));break}case"layout":{let s=this.#e.getValue();this.#e.next(b(b({},s),a));break}case"local":{let s=this.#r.getValue();this.#r.next(b(b({},s),a));break}default:console.warn("Unknown state scope: ",o)}}watchStatePaths(e){return ee(T(o=>{let a={};for(let s of e){let n=Jt(o,s);Qt(a,s,n)}return a}),ae((o,a)=>Vt(o,a)))}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Zr=(()=>{class t extends xe{constructor(){super(...arguments),this.missingTemplateEvent="MISSING_REMOTE_RESOURCE_TEMPLATE"}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=dt(t)))(a||t)}})()}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var qt=class{constructor(){this.environmentInjector=S(pe),this.interpolationService=S(kt)}setLoadingState(r){let e=r.getValue();r.next(H(b({},e),{isLoading:!0}))}setErrorState(r){r.next({status:"error",isLoading:!1,isError:!0,result:null})}setCompleteState(r,e){r.next({status:"completed",isLoading:!1,isError:!1,result:e})}interpolateResourceHooks(r){let{onSuccessHooks:e,resourceResult:o,stateSubscription:a}=r;return this.getResourceRequestHooksInterpolationContext(o,a).pipe(x(i=>this.interpolationService.interpolate({value:e,context:i})),j(()=>(console.warn("Failed to interpolate resource hooks"),l([]))))}getResourceRequestConfigInterpolationContext(r,e){let o=e?L(this.environmentInjector,()=>B(e)):l(null),a=l(r);return P({$requests:a,state:o}).pipe(mt({refCount:!0,bufferSize:1}))}getResourceRequestTransformationInterpolationContext(r){let{accumulatedRequestsResults:e,currentRequestResult:o,stateSubscriptionConfig:a}=r,s=a?L(this.environmentInjector,()=>B(a)):l(null),n=l(e),i=l(o);return P({$requests:n,state:s,$current:i}).pipe(mt({refCount:!0,bufferSize:1}))}getResourceRequestHooksInterpolationContext(r,e){let o=e?L(this.environmentInjector,()=>B(e)):l(null),a=l(r);return P({$result:a,state:o}).pipe(mt({refCount:!0,bufferSize:1}))}};var Vr="[Resource did not run]",to=Symbol("Complete"),Qr=l(to),hc=t=>{let r=S(Vn),e=t.reduce((o,a)=>H(b({},o),{[a]:r.getRemoteResourceState(a)}),{});return P(e).pipe(T(o=>{let a=Object.entries(o).every(([,f])=>f.isLoading),s=Object.entries(o).reduce((f,[p,u])=>u.isLoading?[...f,p]:f,[]),n=Object.entries(o).every(([,f])=>f.isError),i=Object.entries(o).reduce((f,[p,u])=>u.isError?[...f,p]:f,[]);return{results:o,isAllLoading:a,isPartialLoading:s,isAllError:n,isPartialError:i}}))},Vn=(()=>{class t extends qt{#t={};#e=new re;#r=new C(null);#a=S(Yr);#s=S(Zr);#f=S(Ur);getRemoteResourceState(e){let o=this.#t[e];return o?o.asObservable():this.#o(e)}triggerResource(e){this.#t[e]?this.reloadResource(e):this.#o(e)}reloadResource(e){this.#e.next(e)}#p(e,o){let a=0;return l([]).pipe(se(s=>{if(a>=e.length)return Nt;let n=e[a];return a++,this.#c({req:n,accumulatedRequestsResults:s,stateSubscriptionConfig:o}).pipe(x(i=>this.#a.fetchData(n.fetcherId,i)),x(i=>this.#d(n,i,s)),T(i=>[...s,i]))}),ne(),T(s=>s[e.length-1]))}#u(e,o){return this.#n(e,o).pipe(x(a=>Z(a.map(({fetcherId:s,configs:n})=>this.#a.fetchData(s,n)))),x(a=>this.#i({reqs:e,responses:a,stateSubscriptionConfig:o})))}#l(e){let o=this.#t[e];if(!o){console.warn(`Remote resource ${e} has not been registered or is not associated with any widget yet`);return}let a=this.#s.getTemplate(e),s=this.#m(a,o),n=this.#e.pipe(z(f=>f===e)),i=a.pipe(z(f=>f.status==="loaded"),x(f=>{let p=f.config.stateSubscription,u=l(Nt);return p&&(u=L(this.environmentInjector,()=>B(p))),u}));P([n.pipe(ie(!0)),i]).pipe(x(()=>s),fe(this.#r.pipe(z(f=>f===e)))).subscribe(()=>{de(`Remote resource ${e} triggered`)})}#m(e,o){return e.pipe(z(a=>a.status==="loaded"),ct({next:()=>this.setLoadingState(o)}),x(a=>this.#g(a.config).pipe(T(s=>({result:s,rrt:a})))),x(({result:a,rrt:s})=>(this.setCompleteState(o,a),this.#x({resourceResult:a,remoteResourceTemplate:s}))),j(()=>(this.setErrorState(o),Qr)))}#c(e){let{req:o,accumulatedRequestsResults:a,stateSubscriptionConfig:s}=e;return this.getResourceRequestConfigInterpolationContext(a,s).pipe(x(f=>this.interpolationService.interpolate({value:o.configs,context:f})),j(f=>(console.warn(`Fail to interpolate request options: ${f}`),f)),Bt())}#n(e,o){let a=o?L(this.environmentInjector,()=>B(o)):l(null),s=e.map(i=>({fetcherId:i.fetcherId,configs:i.configs}));return a.pipe(x(i=>this.interpolationService.interpolate({value:s,context:i??{}})),j(i=>(console.warn("Fail to interpolate parallel requests options"),i)))}#d(e,o,a){let{interpolation:s}=e;return s?this.getResourceRequestTransformationInterpolationContext({accumulatedRequestsResults:a,currentRequestResult:o}).pipe(x(f=>this.interpolationService.interpolate({value:s,context:f})),j(f=>(console.warn("Failed to interpolate sequenced request result: ",f),f))):l(o)}#i(e){let{reqs:o,responses:a,stateSubscriptionConfig:s}=e,n=[];for(let i=0;i<o.length;i++){let{interpolation:f}=o[i];if(f){let u=this.getResourceRequestTransformationInterpolationContext({currentRequestResult:a[i],stateSubscriptionConfig:s}).pipe(x(d=>this.interpolationService.interpolate({value:f,context:d})),j(d=>(console.warn("Failed to interpolate parallel request result",d),d)),Bt());n.push(u)}}return Z(n)}#o(e){let o=new C({status:"init",isLoading:!0,isError:!1,result:null});return this.#t[e]=o,this.#l(e),o.asObservable()}#x(e){let{resourceResult:o,remoteResourceTemplate:a}=e,{config:{options:{onSuccess:s},stateSubscription:n}}=a;return!s?.length||o===Vr?Qr:this.interpolateResourceHooks({onSuccessHooks:s,resourceResult:o,stateSubscription:n}).pipe(T(i=>(L(this.environmentInjector,()=>{this.#f.triggerActionHooks(i)}),to)))}#h(e){let{stateSubscription:o,runCondition:a}=e;return(o?L(this.environmentInjector,()=>B(o)):l({})).pipe(x(n=>this.interpolationService.interpolate({value:a,context:{state:n}})),j(n=>(console.warn("Failed to interpolate resource run condition: ",n),l(!1))))}#g(e){let{stateSubscription:o,options:{runCondition:a=!0,requests:s,parallel:n}}=e;return this.#h({stateSubscription:o,runCondition:a}).pipe(x(i=>i?n?this.#u(s,o):this.#p(s,o):l(Vr)))}static{this.\u0275fac=(()=>{let e;return function(a){return(e||(e=dt(t)))(a||t)}})()}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var bc=(()=>{class t{#t={};#e={};registerUIElement(e){let{type:o,component:a}=e;this.#t[o]=a}registerUIElementLoader(e){let{type:o,loader:a}=e;this.#e[o]=a}getUIElement(e){let o=this.#t[e];if(!o){let a=this.#e[e];if(a)return a();throw new Error(`${e} has not been registered as a UI Element yet!`)}return Promise.resolve(o)}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{si as a,ni as b,ti as c,Tt as d,Vt as e,Qt as f,Ur as g,Kr as h,kt as i,Yr as j,Ym as k,B as l,Zn as m,Zr as n,hc as o,Vn as p,bc as q};
