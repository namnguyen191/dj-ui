import{a as j}from"./chunk-IH46URXP.js";import{a as N}from"./chunk-AI7ALETR.js";import"./chunk-SWYIOHFY.js";import"./chunk-R6GG5OYM.js";import{e as B}from"./chunk-ZGJ2SCUV.js";import{c as k}from"./chunk-4XPXTYOG.js";import{d as V,f as C}from"./chunk-2HFDSWQC.js";import{b as Q}from"./chunk-XHLVS7FU.js";import"./chunk-JOWTQUES.js";import"./chunk-QZIL3RNM.js";import"./chunk-GKWLEOQ4.js";import"./chunk-66RYNZRF.js";import"./chunk-ERB5ATM7.js";import"./chunk-OFW6W57A.js";import"./chunk-CGO7NXBT.js";import{c as W}from"./chunk-GXVKBTVT.js";import"./chunk-RSTVJZ7U.js";import"./chunk-JVM3WL52.js";import"./chunk-PJHEGPYG.js";import"./chunk-J2UA6UJD.js";import"./chunk-6GF7UK45.js";import"./chunk-CHX6FGWD.js";import{b as q,c as A}from"./chunk-PIPBTUB5.js";import"./chunk-QPCBXCVC.js";import"./chunk-HNFNR3GG.js";import"./chunk-PUECT5W6.js";import"./chunk-POJFSOR5.js";import{Aa as v,Ac as y,Ca as _,Hb as s,Ib as l,Jb as O,Jc as F,Mb as h,Nb as D,Ob as p,Wb as f,Xb as E,_a as a,ea as r,fb as x,gb as d,hc as L,jc as U,kb as c,la as I,ma as S,mb as R,oa as T,ob as b,w,xb as u,za as M,zb as P}from"./chunk-CELOEL42.js";var Y=["uiElementVCR"],$=(()=>{class i{constructor(){this.uiElementTemplate=M.required(),this.uiElementComponentRef=M.required(),this.uiElementVCR=d("uiElementVCR",{read:x})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275dir=R({type:i,viewQuery:function(t,o){t&1&&f(o.uiElementVCR,Y,5,x),t&2&&E()},inputs:{uiElementTemplate:[1,"uiElementTemplate"],uiElementComponentRef:[1,"uiElementComponentRef"]}})}}return i})();var z=["contextMenu"],g=class i extends ${constructor(){super(...arguments),this.#e=r(F),this.#t=r(C),this.menuItemsSig=_([]),this.isContextMenuShow=_(!1),this._contextMenuEleSig=d("contextMenu",{read:v}),this.#i=e=>{this.#o(e)&&e.preventDefault()},this.#n=e=>{if(this.#l(e)){this.isContextMenuShow.set(!1);return}}}static{this.EXCLUDED_ELEMENTS=new Set([Q])}#e;#t;#i;displayMenu(e){if(this.#s(e)){e.stopPropagation();let n=y(this._contextMenuEleSig)?.nativeElement;if(!n){console.error("Something is wrong. Context menu element is not found!");return}let t=`${e.clientX}px`,o=`${e.clientY}px`;n.style.setProperty("--pos-x",t),n.style.setProperty("--pos-y",o),this.isContextMenuShow.set(!0);let m=y(this.uiElementTemplate).id;this.menuItemsSig.set([{label:`Edit ${m}`,icon:"pi pi-cog",command:()=>{this.#t.navigate(["builder","ui-element",m])}}])}}#n;ngOnInit(){this.#e.addEventListener("contextmenu",this.#i),this.#e.addEventListener("mouseup",this.#n,{passive:!0})}ngOnDestroy(){this.#e.removeEventListener("contextmenu",this.#i),this.#e.removeEventListener("mouseup",this.#n)}#r(e){let n=y(this.uiElementComponentRef).instance.uid,t=e.target;for(;t.parentElement;){if(t.getAttribute("uid")===n)return t;t=t.parentElement}return null}#a(e){let n=e.target;for(;n.parentElement;){if(n.id==="context-menu")return!0;n=n.parentElement}return!1}#o(e){return!!this.#r(e)}#s(e){return e.button===2&&this.#o(e)}#l(e){return e.button===0&&!this.#a(e)}static{this.\u0275fac=(()=>{let e;return function(t){return(e||(e=T(i)))(t||i)}})()}static{this.\u0275cmp=c({type:i,selectors:[["prime-ng-playground-builder-feat-layout-editor-context-menu"]],viewQuery:function(n,t){n&1&&f(t._contextMenuEleSig,z,5,v),n&2&&E()},features:[b],decls:6,vars:5,consts:[["uiElementVCR",""],["contextMenu",""],[2,"display","contents",3,"mouseup"],["id","context-menu",1,"context-menu"],[3,"model"]],template:function(n,t){if(n&1){let o=D();s(0,"div",2),p("mouseup",function(G){return I(o),S(t.displayMenu(G))}),h(1,null,0),l(),s(3,"span",3,1),O(5,"p-menu",4),l()}n&2&&(a(3),P("hide",!t.isContextMenuShow())("show",t.isContextMenuShow()),a(2),u("model",t.menuItemsSig()))},dependencies:[j],styles:["[_nghost-%COMP%]{display:contents;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:fixed;top:var(--pos-y);left:var(--pos-x);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}};var H=i=>({id:i,isLayout:!0}),ve=(()=>{class i{#e;#t;#i;#n;constructor(){this.#e=r(B),this.#t=r(V),this.#i=r(C),this.currentUIElementTemplateId=this.#t.snapshot.params.id,this.#n="editRawTemplate",this.isRawTemplateEditorModalOpenSig=k(this.#t.queryParams.pipe(w(n=>n[this.#n]==="true")),{initialValue:!1}),this.#e.updateQuery({id:this.currentUIElementTemplateId})}toggleModal(n){this.#i.navigate([],{relativeTo:this.#t,queryParams:{[this.#n]:n?!0:null},queryParamsHandling:"merge"})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275cmp=c({type:i,selectors:[["prime-ng-playground-builder-feat-edit-layout-template"]],features:[L([{provide:q,useFactory:()=>({uiElementWrapperComponent:g})}])],decls:3,vars:5,consts:[["aria-label","Open template editor","icon","pi pi-file-edit","iconPos","bottom","label","Open template editor",1,"open-template-editor-btn",3,"click"],[3,"djuiUIElementRenderer"],[3,"editCancel","query","visible"]],template:function(t,o){t&1&&(s(0,"p-button",0),p("click",function(){return o.toggleModal(!0)}),l(),h(1,1),s(2,"prime-ng-playground-builder-feat-raw-ui-element-template-editor-modal",2),p("editCancel",function(){return o.toggleModal(!1)}),l()),t&2&&(a(),u("djuiUIElementRenderer",o.currentUIElementTemplateId),a(),u("query",U(3,H,o.currentUIElementTemplateId))("visible",o.isRawTemplateEditorModalOpenSig()))},dependencies:[A,N,W],styles:["[_nghost-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]{position:absolute;z-index:9997;top:1rem;right:1rem;opacity:.1;transition:opacity .2s ease-in}[_nghost-%COMP%]   .open-template-editor-btn[_ngcontent-%COMP%]:hover{opacity:1}"],changeDetection:0})}}return i})();export{ve as EditLayoutTemplateComponent};
