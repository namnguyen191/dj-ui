import{a as W,b as $e,c as Ze,d as et,e as tt}from"./chunk-I5PBYSSJ.js";import{b as Oe}from"./chunk-GPOOD65C.js";import{a as Je}from"./chunk-U2VGY55C.js";import{a as be,b as we}from"./chunk-L5NMP2FE.js";import{a as Ve,b as Ae}from"./chunk-KZUONKLL.js";import{a as U}from"./chunk-USLHN7MQ.js";import{a as Qe,b as Ge,c as Ye,e as Ke,f as Xe}from"./chunk-T3L4ARYN.js";import{a as Fe,b as Ne,c as Re,d as je,e as He,f as We,g as Ue,h as qe}from"./chunk-6SCYMS46.js";import"./chunk-TR37QBXV.js";import"./chunk-F4NWCRCH.js";import{c as Be}from"./chunk-WPXIDDMA.js";import"./chunk-V5OFWGIA.js";import"./chunk-UFUCDWUH.js";import"./chunk-MPFOZAIW.js";import{D as H,p as Pe,t as ze}from"./chunk-JKCAMHHX.js";import{b as ke,d as De,e as j}from"./chunk-YNHIMEB6.js";import{d as Ie,f as xe}from"./chunk-4BUORYHE.js";import{a as R,b as I,c as x}from"./chunk-XND63YGZ.js";import"./chunk-43ECEIE2.js";import{c as ie}from"./chunk-4J2NRGXX.js";import"./chunk-XIV2GB5G.js";import"./chunk-DON54MFE.js";import"./chunk-SQVMHEBP.js";import"./chunk-I7O7BTAO.js";import{$a as r,Ba as k,Bb as $,Ca as Y,Cb as a,Cc as te,Eb as V,Ec as T,F as ce,Fc as N,Hb as Z,Kc as Te,Mb as s,Nb as l,Ob as u,Pb as f,Qb as C,Rb as fe,Rc as Le,Sb as w,Tb as _,Ub as c,Uc as O,V as G,Vb as ee,Wb as A,Yc as ne,_ as me,_c as L,ac as B,bc as F,cb as K,da as m,dc as g,ec as Ce,f as se,fb as X,gc as _e,hb as D,hc as he,ib as P,ic as ye,jc as Ee,ma as v,mb as E,mc as ve,na as M,nb as ue,oa as y,ob as ge,oc as Me,pa as S,qb as z,r as de,sc as Se,tb as p,wa as pe}from"./chunk-U5SMYZY3.js";import{a as b,b as re,c as le}from"./chunk-Q7L6LLAK.js";var ut=["uiElementVCR"],nt=(()=>{class t{constructor(){this.uiElementTemplate=k.required(),this.uiElementInstance=k.required(),this.uiElementComponentRef=k.required(),this.uiElementVCR=P("uiElementVCR",{read:X})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275dir=ge({type:t,viewQuery:function(n,i){n&1&&B(i.uiElementVCR,ut,5,X),n&2&&F()},inputs:{uiElementTemplate:[1,"uiElementTemplate"],uiElementInstance:[1,"uiElementInstance"],uiElementComponentRef:[1,"uiElementComponentRef"]}})}}return t})();var it={elem:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",fill:"currentColor",width:16,height:16},content:[{elem:"circle",attrs:{cx:"23",cy:"24",r:"2"}},{elem:"path",attrs:{d:"M30.7769 23.4785A8.64 8.64 0 0023 18a8.64 8.64 0 00-7.7769 5.4785L15 24l.2231.5215A8.64 8.64 0 0023 30a8.64 8.64 0 007.7769-5.4785L31 24zM23 28a4 4 0 114-4A4.0045 4.0045 0 0123 28zM12.3989 20.8A6 6 0 1122 16H20a4 4 0 10-6.4 3.2z"}},{elem:"path",attrs:{d:"M29.3047,11.0439,26.9441,6.9561a1.9977,1.9977,0,0,0-2.3728-.8946l-2.4341.8233a11.0419,11.0419,0,0,0-1.312-.7583l-.5037-2.5186A2,2,0,0,0,18.36,2H13.64a2,2,0,0,0-1.9611,1.6079l-.5037,2.5186A10.9666,10.9666,0,0,0,9.8481,6.88L7.4287,6.0615a1.9977,1.9977,0,0,0-2.3728.8946L2.6953,11.0439a2.0006,2.0006,0,0,0,.4119,2.5025l1.9309,1.6968C5.021,15.4946,5,15.7446,5,16c0,.2578.01.5127.0278.7656l-1.9206,1.688a2.0006,2.0006,0,0,0-.4119,2.5025l2.3606,4.0878a1.9977,1.9977,0,0,0,2.3728.8946l2.4341-.8233a10.9736,10.9736,0,0,0,1.312.7583l.5037,2.5186A2,2,0,0,0,13.64,30H15V28H13.64l-.71-3.5508a9.0953,9.0953,0,0,1-2.6948-1.5713l-3.4468,1.166-2.36-4.0878L7.1528,17.561a8.9263,8.9263,0,0,1-.007-3.1279L4.4275,12.0439,6.7886,7.9561l3.4267,1.1591a9.0305,9.0305,0,0,1,2.7141-1.5644L13.64,4H18.36l.71,3.5508a9.0978,9.0978,0,0,1,2.6948,1.5713l3.4468-1.166,2.36,4.0878-2.7978,2.4522L26.0923,16l2.8-2.4536A2.0006,2.0006,0,0,0,29.3047,11.0439Z"}}],name:"settings--view",size:16};var ft=["*"],Ct=(t,o,e,n,i,d,h,Q,ct,mt,pt)=>({"cds--contained-list--inset-rulers":t,"cds--contained-list--on-page":o,"cds--contained-list--disclosed":e,"cds--contained-list--sm":n,"cds--contained-list--md":i,"cds--contained-list--lg":d,"cds--contained-list--xl":h,"cds--layout--size-sm":Q,"cds--layout--size-md":ct,"cds--layout--size-lg":mt,"cds--layout--size-xl":pt});function _t(t,o){if(t&1&&(f(0),g(1),C()),t&2){let e=c();r(),Ce(e.label)}}function ht(t,o){}function yt(t,o){if(t&1&&p(0,ht,0,0,"ng-template",6),t&2){let e=c();a("ngTemplateOutlet",e.label)}}function Et(t,o){}function vt(t,o){if(t&1&&(s(0,"div",7),p(1,Et,0,0,"ng-template",6),l()),t&2){let e=c();r(),a("ngTemplateOutlet",e.action)}}var Mt=[[["","cdsContainedListItemButton",""],["","ibmContainedListItemButton",""]],"*"],St=["[cdsContainedListItemButton],[ibmContainedListItemButton]","*"],Tt=t=>({$implicit:t});function Lt(t,o){if(t&1){let e=w();f(0),s(1,"button",2),_("click",function(){v(e);let i=c();return M(i.onClick())}),A(2),l(),C()}if(t&2){let e=c();r(),a("disabled",e.disabled)}}function It(t,o){if(t&1&&(f(0),y(),u(1,"svg",6),C()),t&2){let e=c(3);r(),a("ibmIcon",e.icon)}}function xt(t,o){}function bt(t,o){if(t&1&&p(0,xt,0,0,"ng-template",7),t&2){let e=c(3);a("ngTemplateOutlet",e.icon)}}function wt(t,o){if(t&1&&(s(0,"div",5),p(1,It,2,1,"ng-container",0)(2,bt,1,1,null,0),l()),t&2){let e=c(2);r(),a("ngIf",!e.isTemplate(e.icon)),r(),a("ngIf",e.isTemplate(e.icon))}}function Ot(t,o){if(t&1&&(f(0),s(1,"div",3),p(2,wt,3,2,"div",4),A(3,1),l(),C()),t&2){let e=c();r(2),a("ngIf",e.icon)}}function kt(t,o){}function Dt(t,o){if(t&1&&(s(0,"div",8),p(1,kt,0,0,"ng-template",9),l()),t&2){let e=c();r(),a("ngTemplateOutlet",e.action)("ngTemplateOutletContext",Me(2,Tt,e.actionData))}}var oe=function(t){return t.Small="sm",t.Medium="md",t.Large="lg",t.ExtraLarge="xl",t}(oe||{}),ae=function(t){return t.OnPage="on-page",t.Disclosed="disclosed",t}(ae||{}),ot=(()=>{class t{constructor(){this.isInset=!1,this.kind=ae.OnPage,this.size=oe.Large,this.labelId=`contained-list-${t.count++}-header`,this.ContainedListSize=oe,this.ContainedListKind=ae}isTemplate(e){return e instanceof K}}return t.count=0,t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=E({type:t,selectors:[["cds-contained-list"],["ibm-contained-list"]],inputs:{action:"action",isInset:"isInset",kind:"kind",label:"label",size:"size",labelId:"labelId"},standalone:!1,ngContentSelectors:ft,decls:8,vars:18,consts:[[1,"cds--contained-list",3,"ngClass"],[1,"cds--contained-list__header"],[1,"cds--contained-list__label",3,"id"],[4,"ngIf"],["class","cds--contained-list__action",4,"ngIf"],["role","list"],[3,"ngTemplateOutlet"],[1,"cds--contained-list__action"]],template:function(e,n){e&1&&(ee(),s(0,"div",0)(1,"div",1)(2,"div",2),p(3,_t,2,1,"ng-container",3)(4,yt,1,1,null,3),l(),p(5,vt,2,1,"div",4),l(),s(6,"div",5),A(7),l()()),e&2&&(a("ngClass",Se(6,Ct,[n.isInset,n.kind===n.ContainedListKind.OnPage,n.kind===n.ContainedListKind.Disclosed,n.size===n.ContainedListSize.Small,n.size===n.ContainedListSize.Medium,n.size===n.ContainedListSize.Large,n.size===n.ContainedListSize.ExtraLarge,n.size===n.ContainedListSize.Small,n.size===n.ContainedListSize.Medium,n.size===n.ContainedListSize.Large,n.size===n.ContainedListSize.ExtraLarge])),r(2),a("id",n.labelId),r(),a("ngIf",!n.isTemplate(n.label)),r(),a("ngIf",n.isTemplate(n.label)),r(),a("ngIf",n.action),r(),$("aria-labelledby",n.labelId))},dependencies:[Le,O,ne],encapsulation:2,changeDetection:0}),t})(),at=(()=>{class t{constructor(){this.disabled=!1,this.click=new pe,this.itemClass=!0,this.role="listitem"}get itemClickableClass(){return this.clickable}get itemWithIconClass(){return!!this.icon}onClick(){this.click.emit()}isTemplate(e){return e instanceof K}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=E({type:t,selectors:[["cds-contained-list-item"],["ibm-contained-list-item"]],hostVars:7,hostBindings:function(e,n){e&2&&($("role",n.role),V("cds--contained-list-item",n.itemClass)("cds--contained-list-item--clickable",n.itemClickableClass)("cds--contained-list-item--with-icon",n.itemWithIconClass))},inputs:{action:"action",actionData:"actionData",disabled:"disabled",clickable:"clickable",icon:"icon"},outputs:{click:"click"},standalone:!1,ngContentSelectors:St,decls:3,vars:3,consts:[[4,"ngIf"],["class","cds--contained-list-item__action",4,"ngIf"],["type","button",1,"cds--contained-list-item__content",3,"click","disabled"],[1,"cds--contained-list-item__content"],["class","cds--contained-list-item__icon",4,"ngIf"],[1,"cds--contained-list-item__icon"],["size","16",3,"ibmIcon"],[3,"ngTemplateOutlet"],[1,"cds--contained-list-item__action"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){e&1&&(ee(Mt),p(0,Lt,3,1,"ng-container",0)(1,Ot,4,1,"ng-container",0)(2,Dt,2,4,"div",1)),e&2&&(a("ngIf",n.clickable),r(),a("ngIf",!n.clickable),r(),a("ngIf",n.action))},dependencies:[O,ne,I],encapsulation:2,changeDetection:0}),t})(),rt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ue({type:t}),t.\u0275inj=me({imports:[L,x]}),t})();var zt=["contextMenu"],st=(()=>{class t extends nt{#e;#n;#t;#i;constructor(){super(),this.#e=m(Te),this.#n=m(R),this.isContextMenuShow=D(!1),this._contextMenuEleSig=P("contextMenu",{read:Y}),this.#t=e=>{this.#r(e)&&e.preventDefault()},this.#i=e=>{if(this.#s(e)){this.isContextMenuShow.set(!1);return}if(this.#l(e)&&!this.#o(e)){let n=T(this._contextMenuEleSig)?.nativeElement;if(!n){console.error("Something is wrong. Context menu element is not found!");return}let d=this.#a(e).getBoundingClientRect(),h=`${e.clientX-d.left}px`,Q=`${e.clientY-d.top}px`;n.style.setProperty("--pos-x",h),n.style.setProperty("--pos-y",Q),this.isContextMenuShow.set(!0)}},this.#n.registerAll([W,it])}ngOnInit(){this.#e.addEventListener("contextmenu",this.#t),this.#e.addEventListener("mouseup",this.#i,{passive:!0})}ngOnDestroy(){this.#e.removeEventListener("contextmenu",this.#t),this.#e.removeEventListener("mouseup",this.#i)}#a(e){let n=T(this.uiElementInstance)?.id;if(!n)throw new Error("Element instance ID has not been received");let i=e.target;for(;i.parentElement;){if(i.tagName.toLowerCase()==="gridster-item"&&i.id===n)return i;i=i.parentElement}return null}#o(e){let n=e.target;for(;n.parentElement;){if(n.id==="context-menu")return!0;n=n.parentElement}return!1}#r(e){return!!this.#a(e)}#l(e){return e.button===2&&this.#r(e)}#s(e){return e.button===0&&!this.#o(e)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=E({type:t,selectors:[["namnguyen191-dui-ui-element-builder-context-menu-wrapper"]],viewQuery:function(n,i){n&1&&B(i._contextMenuEleSig,zt,5,Y),n&2&&F()},features:[z],decls:28,vars:8,consts:[["uiElementVCR",""],["contextMenu",""],["id","context-menu","label","Control menu",1,"context-menu"],[3,"clickable"],["ibmContainedListItemButton",""],[1,"control-menu-item"],["cdsIcon","edit","size","16"],["cdsIcon","settings--view","size","16"],["cdsIcon","copy","size","16"],["cdsIcon","trash-can","size","16"]],template:function(n,i){n&1&&(fe(0,null,0),s(2,"cds-contained-list",2,1)(4,"cds-contained-list-item",3),f(5,4),s(6,"div",5)(7,"span"),g(8,"Edit"),l(),y(),u(9,"svg",6),l(),C(),l(),S(),s(10,"cds-contained-list-item",3),f(11,4),s(12,"div",5)(13,"span"),g(14,"View details"),l(),y(),u(15,"svg",7),l(),C(),l(),S(),s(16,"cds-contained-list-item",3),f(17,4),s(18,"div",5)(19,"span"),g(20,"Duplicate"),l(),y(),u(21,"svg",8),l(),C(),l(),S(),s(22,"cds-contained-list-item",3),f(23,4),s(24,"div",5)(25,"span"),g(26,"Delete"),l(),y(),u(27,"svg",9),l(),C(),l()()),n&2&&(r(2),V("hide",!i.isContextMenuShow())("show",i.isContextMenuShow()),r(2),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0),r(6),a("clickable",!0))},dependencies:[L,rt,ot,at,x,I],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;position:relative}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]{position:absolute;top:var(--pos-y);left:var(--pos-x);width:10rem;background:var(--cds-layer-active-01);transition:opacity .5s ease,display .5s ease;transition-behavior:allow-discrete}[_nghost-%COMP%]   .context-menu.show[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .context-menu.hide[_ngcontent-%COMP%]{opacity:0;display:none;transition-duration:.5s;transition-timing-function:ease-out}[_nghost-%COMP%]   .context-menu[_ngcontent-%COMP%]   .control-menu-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}@starting-style{.context-menu.show[_ngcontent-%COMP%]{opacity:0}}"],changeDetection:0})}}return t})();var Vt={currentEditingTemplate:null},J=Ge({providedIn:"root"},Xe(Vt),Ye(({currentEditingTemplate:t})=>({currentEditableFields:te(()=>{let o=t();if(!o)return null;let h=o,{id:e,createdAt:n,updatedAt:i}=h;return le(h,["id","createdAt","updatedAt"])}),currentUnEditableFields:te(()=>{let o=t();if(!o)return null;let{id:e,createdAt:n,updatedAt:i}=o;return{id:e,createdAt:n,updatedAt:i}})})),Ke(t=>({setCurrentEditingTemplate:o=>{Qe(t,{currentEditingTemplate:o})},updateCurrentEditingTemplate:o=>{$e(t,e=>{e.currentEditingTemplate&&(e.currentEditingTemplate=b(b({},e.currentEditingTemplate),o))})}})));function At(t,o){t&1&&u(0,"cds-loading",5),t&2&&a("isActive",!0)}function Bt(t,o){if(t&1){let e=w();s(0,"ngx-monaco-editor",9),ye("ngModelChange",function(i){v(e);let d=c();return he(d.code,i)||(d.code=i),M(i)}),_("ngModelChange",function(i){v(e);let d=c();return M(d.codeChangeSubject.next(i))}),l()}if(t&2){let e=c();a("options",e.editorOptions),_e("ngModel",e.code)}}function Ft(t,o){t&1&&g(0," Error in JSON ")}function Nt(t,o){t&1&&g(0," Save your changes ")}function Rt(t,o){t&1&&u(0,"cds-loading",10)}var dt=(()=>{class t extends Fe{#e;#n;#t;constructor(){super(),this.#e=m(U),this.#n=m(J),this.loadingSig=this.#e.isPending,this.codeChangeSubject=new se,this.editorOptions={theme:"vs-dark",language:"json",wordWrap:"on"},this.code="",this.errorStateSig=D("noError"),this.#t="",this.codeChangeSubject.pipe(G({next:()=>this.errorStateSig.set("isPending")}),ce(500),G({next:e=>{this.#o(e)?this.errorStateSig.set("noError"):this.errorStateSig.set("isError")}}),be()).subscribe(),this.#i()}async updateLayoutTemplate(){let e=JSON.parse(this.code);this.#n.updateCurrentEditingTemplate(e);let n=T(this.#n.currentEditingTemplate);if(!n){console.error("Edited template is missing from store");return}await this.#e.change(n),T(this.#e.error)||this.closeModal()}#i(){N(async()=>{let e=this.#n.currentEditableFields();if(!e)return;let n=JSON.stringify(e),i=await this.#a(n);this.code=this.#t=i})}async#a(e){return await tt(e,{parser:"json",plugins:[Ze,et]})}#o(e){try{return JSON.parse(e),!0}catch(n){return console.log("Something went wrong:",n),!1}}closeModal(){this.code=this.#t,super.closeModal()}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=E({type:t,selectors:[["namnguyen191-layout-template-code-editor-modal"]],features:[z],decls:15,vars:6,consts:[["size","lg",3,"overlaySelected","open"],[3,"closeSelect","showCloseButton"],["cdsModalHeaderLabel",""],["cdsModalHeaderHeading",""],["cdsModalContent","",1,"modal-body"],[3,"isActive"],[1,"editor-container",3,"options","ngModel"],["cdsButton","primary",3,"click","disabled"],["size","sm",4,"ngIf"],[1,"editor-container",3,"ngModelChange","options","ngModel"],["size","sm"]],template:function(n,i){if(n&1){let d=w();Ee(0),s(1,"cds-modal",0),_("overlaySelected",function(){return v(d),M(i.closeModal())}),s(2,"cds-modal-header",1),_("closeSelect",function(){return v(d),M(i.closeModal())}),s(3,"h2",2),g(4,"Editor"),l(),s(5,"h3",3),g(6,"Edit your template in JSON"),l()(),s(7,"section",4),p(8,At,1,1,"cds-loading",5)(9,Bt,1,2,"ngx-monaco-editor",6),l(),s(10,"cds-modal-footer")(11,"button",7),_("click",function(){return v(d),M(i.updateLayoutTemplate())}),p(12,Ft,1,0)(13,Nt,1,0)(14,Rt,1,0,"cds-loading",8),l()()()}if(n&2){let d=i.errorStateSig();r(),a("open",i.open),r(),a("showCloseButton",!0),r(6),Z(i.loadingSig()||!i.code?8:9),r(3),a("disabled",d==="isError"||d==="isPending"),r(),Z(d==="isError"?12:13),r(2),a("ngIf",d==="isPending")}},dependencies:[L,O,qe,Ne,Re,je,He,We,Ue,Je,H,Pe,ze,Ae,Ve,j,ke,Be],styles:["[_nghost-%COMP%]{display:contents}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]{height:70vh;display:flex;justify-content:center;align-items:center}[_nghost-%COMP%]   .modal-body[_ngcontent-%COMP%]   .editor-container[_ngcontent-%COMP%]{height:100%;flex:1}"],changeDetection:0})}}return t})();var Jn=(()=>{class t{#e;#n;#t;#i;#a;#o;constructor(){this.#e=m(Ie),this.#n=m(xe),this.#t=m(U),this.#i=m(J),this.#a=m(R),this.currentLayoutTemplateId=this.#e.snapshot.params.id,this.#o="editRawTemplate",this.isRawTemplateEditorModalOpenSig=we(this.#e.queryParams.pipe(de(e=>e[this.#o]==="true")),{initialValue:!1}),this.#a.registerAll([W]),this.#t.updateQuery({id:this.currentLayoutTemplateId}),this.#r()}toggleModal(e){this.#n.navigate([],{relativeTo:this.#e,queryParams:{[this.#o]:e?!0:null},queryParamsHandling:"merge"})}#r(){N(()=>{let e=this.#t.filteredLayoutTemplates()[0];e&&this.#i.setCurrentEditingTemplate(e)})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=E({type:t,selectors:[["namnguyen191-edit-layout-page"]],features:[ve([{provide:ie,useFactory:()=>{let e=m(ie,{skipSelf:!0});return re(b({},e),{uiElementExtraWrapperComponent:st})}}])],decls:4,vars:3,consts:[[3,"layoutId"],["type","button",1,"edit-template-button",3,"click","kind"],["cdsIcon","edit","size","16",1,"cds--btn__icon"],[3,"close","open"]],template:function(n,i){n&1&&(u(0,"djui",0),s(1,"cds-icon-button",1),_("click",function(){return i.toggleModal(!0)}),y(),u(2,"svg",2),l(),S(),s(3,"namnguyen191-layout-template-code-editor-modal",3),_("close",function(){return i.toggleModal(!1)}),l()),n&2&&(a("layoutId",i.currentLayoutTemplateId),r(),a("kind","primary"),r(2),a("open",i.isRawTemplateEditorModalOpenSig()))},dependencies:[Oe,H,j,De,x,I,dt],styles:["[_nghost-%COMP%]{min-height:calc(100vh - 3rem);display:block;position:relative}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;opacity:.25;z-index:1000}[_nghost-%COMP%]   .edit-template-button[_ngcontent-%COMP%]:hover{opacity:1}[_nghost-%COMP%]     gridster-item{background-color:#0003}"],changeDetection:0})}}return t})();export{Jn as EditLayoutPageComponent};
